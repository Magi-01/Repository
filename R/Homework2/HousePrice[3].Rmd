---
title: "Homework 2"
author: "Urbani Ludovico, Mohamed Fadhla Mutua, Florin Razvan Burlacu"
date: "2024-02-01"
output:
  word_document: default
  pdf_document: default
  html_document: default
---

# Impostazioni progetto

```{r, warning = F}
library(ggplot2)

plot_theme = theme_minimal() +
    theme(
        plot.title = element_text(face = "bold", hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.line = element_line(color = "darkgrey", size = 0.4),
        axis.ticks = element_line(color = "black"))
theme_set(plot_theme)
```

# House Price - Univariata Quantitativa

## Lettura dati

```{r, warning = F}
HP <- read.csv2(
    "./house_price.csv", 
    sep = ",", 
    stringsAsFactors = T,
    row.names=1)
```


## Scelta delle colonne

```{r, warning = F}
column_selection <- function(data){
  HP_numeric_bool = sapply(data, is.numeric)
  HP_numeric_fcolnames = names(data[HP_numeric_bool])
  # Rimozione delle colonne
  HP_numeric_fcolnames = HP_numeric_fcolnames[c(-1,-4,-5)]
  print("Colonne scelte: ")
  print(HP_numeric_fcolnames)
  return(HP_numeric_fcolnames)
}
HP_numeric_colnames = column_selection(HP)
```

## Analisi Primaria

```{r, warning = F}
Analisi_Primaria <- function(data){
  print(paste("Numeri di osservazione: ",ncol(data)))
  print(paste("Numeri di variabili: ",nrow(data)))
}
Analisi_Primaria(HP[ ,HP_numeric_colnames])
str(HP[,HP_numeric_colnames])
```

## Analisi Univariata

```{r, warning = F}
univariate_analysis <- function(data, colname) {
  result = list()
  
  result[[colname]] = list(
    # Summary statistics including min, 1st and 3rd quartile, mean, median, max
    Summary = summary(data),
    # Variance
    Variance = round(var(data), 2),
    # Standard Deviation
    Standard_Deviation = round(sd(data), 2),
    # Mode calculation
    Moda = Mode(data)
  )
  return(result)
}

Mode <- function(data) {
  uniq_vals = unique(data)
  tab = tabulate(match(data, uniq_vals))
  modes = uniq_vals[tab == max(tab)]
  list(Mode = modes, Frequency = max(tab))
}
```

## Analisi non modificato

```{r, warning = F}
sum_info_h = lapply(HP_numeric_colnames, function(ele) {
  colummn = na.omit(HP[, ele])
  univariate_analysis(colummn, ele)
})
```

## Funzione di Visualizazione continuo

```{r, warning = F}
visualization_continuos <- function(data,sumary,colname){
  par(mfrow = c(2,2))
  print(sumary)
  boxplot(data, horizontal = T, main = paste("Boxplot of ", colname))
  hist(data, probability = T, col = 2, main = paste("Hist of ", colname))
  curve(dnorm(x, mean = mean(data), sd = sd(data)),
        add=T, col = 4)
  print(density(data))
  plot(density(data), main = paste("Desnity Distribution of ", colname))
  qqnorm(data, col = 3, main = paste("QQnorm of ", colname))
  qqline(data, col = 5, pch = 10)
}
```

## Funzione di visualizazione discreta

```{r, warning = F}
visualization_discrete <- function(data,sumary,colname){
  par(mfrow = c(1,1))
  print(sumary)
  print("freq: ")
  cat("\n")
  print(table(data))
  cat("\n")
  print("percintile: ")
  cat("\n")
  print(prop.table(table(data))*100)
  cat("\n")
  barplot(table(data), col = 2, main = paste("Barplot of ", colname))
}
```

## Rimozione degli zero

```{r, warning = F}
rm_0 <- function(data){
  imp_data = data
  imp_data[imp_data == 0] = NA
  imp_data = na.omit(imp_data)
  return(imp_data)
}
```

## Rimozione degli outlier attraverso intervallo di confidenza

```{r, warning = F}
rm_oultiers <- function(data, CI){
  mean_data = mean(data)
  sd_data = sd(data)
  confidence_level = CI
  z_score = qnorm((1 + confidence_level) / 2)
  
  lower_bound = mean_data - z_score * sd_data
  upper_bound = mean_data + z_score * sd_data
  
  data_in_ci = data[data >= lower_bound & data <= upper_bound]
  return(data_in_ci)
}
```

## Analisi

### LotFrontage

```{r, warning = F}
visualization_continuos(na.omit(HP[,"LotFrontage"]), sum_info_h[1],"LotFrontage")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte degli lotti ha un percorso verso la strada compreso tra 59 e 80 piedi, essendo rispettivamente il 1° e il 3° quantile e maggiormente alineati alla retta qq della norma. Rimangono ancora degli outlier

#### Rimozione di outlier

```{r, warning = F}
rm_outlier_data = rm_oultiers(na.omit(HP[,"LotFrontage"]),.90)
visualization_continuos(rm_outlier_data, univariate_analysis(rm_outlier_data,"LotFrontage"),"LotFrontage")
```

Possiamo osservare che la distribuzione segue per lo piu quella gaussiana e che la maggior parte degli lotti ha un percorso verso la strada compreso tra 60 e 80 piedi, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma.

### LotArea

```{r, warning = F}
visualization_continuos(na.omit(HP[,"LotArea"]), sum_info_h[2],"LotArea")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte degli lotti ha un area compreso tra 7554 e 11602 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e e con maggior densita alineati alla retta qq della norma. Rimangono ancora degli outlier

#### Rimozione di outlier

```{r, warning = F}
rm_outlier_data = rm_oultiers(na.omit(HP[,"LotArea"]),.50)
visualization_continuos(rm_outlier_data, univariate_analysis(rm_outlier_data,"LotArea"),"LotArea")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte degli lotti ha un area compreso tra 7500 e 11362 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Da notare che si butano il 50% dei dat

### YearBuilt

```{r, warning = F}
visualization_continuos(na.omit(HP[,"YearBuilt"]), sum_info_h[3],"YearBuilt")
```

Possiamo dedurre che la distribuzione è negativamente asimetrica e quindi il numero di edifici costruiti crescono ogni anno La maggior parte degli edifici erano costruiti fra 1954 e 2000, essendo rispettivamente il 1° e il 3° quantile e l'anno con è il massimo costruitto è nel 2006 con 67 edifici

### YearRemodAd

```{r, warning = F}
visualization_continuos(na.omit(HP[,"YearRemodAdd"]), sum_info_h[4], "YearBuilt")
```

Possiamo notare che la distribuzione ha un pico negli anni 50 con il massimo di rimodellazione nel 1950 con 178 edifici. Dopodichè, si ha un calo quasi immediato e i numeri di edifici rimodellati resta quasi costante fino agli anni 80 dove fra il 1980 al 1985 si nota il minimo numero di rimodellazione. Dopodiche, la distribuzione inizia a crescere quasi costantemente con pico negli anni fra 2000 e 2005

### MasVnrArea

```{r, warning = F}
visualization_continuos(na.omit(HP[,"MasVnrArea"]), sum_info_h[5],"MasVnrArea")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica. Si puo osservare che l'area di MasVnrArea è prelevantemete 0 qundi non applicato. Per fare un analisi sugli edifici che hanno il Masonry veneer, serve ignorare quelli senza

#### Rimozione degli zero

```{r, warning = F}
rm_0_data = rm_0(na.omit(HP[,"MasVnrArea"]))
visualization_continuos(rm_0_data, univariate_analysis(rm_0_data,"MasVnrArea"),"MasVnrArea")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte degli edifici ha un area coperto da Masonry veneer tra 113.0 e 330.5 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Rimangono ancora degli outlier

#### Rimozione di oultier

```{r, warning = F}
rm_outlier_data = rm_oultiers(rm_0_data,.90)
visualization_continuos(rm_outlier_data, univariate_analysis(rm_outlier_data,"MasVnrArea"),"MasVnrArea")
```

Possiamo dedurre nella distribuzione che la maggior parte degli edifici ha un area coperto da Masonry veneer tra 108.5 e 304.0 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma.

### BsmtFinSF1

```{r, warning = F}
visualization_continuos(na.omit(HP[,"BsmtFinSF1"]), sum_info_h[6],"BsmtFinSF1")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica. Si puo osservare che l'area finito di semiterrato finito di tipo 1 è prelevantemete 0 qundi non costruitto. Per fare un analisi sugli edifici che hanno il semiterrato finito di tipo 1, serve ignorare quelli senza

#### Rimozione degli zero

```{r, warning = F}
rm_0_data = rm_0(na.omit(HP[,"BsmtFinSF1"]))
visualization_continuos(rm_0_data, univariate_analysis(rm_0_data,"BsmtFinSF1"),"BsmtFinSF1")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte degli edifici ha un semiterrato finito di tipo 1 di area compresa tra 371.0 e 867.0 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Rimangono ancora degli outlier

#### Rimozione di outlier

```{r, warning = F}
rm_outlier_data = rm_oultiers(rm_0_data,.95)
visualization_continuos(rm_outlier_data, univariate_analysis(rm_outlier_data,"BsmtFinSF1"),"BsmtFinSF1")
```

Possiamo dedurre nella distribuzione semi-normato che la maggior parte degli edifici ha un semiterrato finito di tipo 1 di area compresa tra 364.8 e 833.8 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma.

### BsmtFinSF2

```{r, warning = F}
visualization_continuos(na.omit(HP[,"BsmtFinSF2"]), sum_info_h[7],"BsmtFinSF2")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica. Si puo osservare che l'area finito di semiterrato finito di tipo 2 è prelevantemete 0 qundi non costruitto. Per fare un analisi sugli edifici che hanno il semiterrato finito di tipo 2, serve ignorare quelli senza

#### Rimozione degli zero

```{r, warning = F}
rm_0_data = rm_0(na.omit(HP[,"BsmtFinSF2"]))
visualization_continuos(rm_0_data, univariate_analysis(rm_0_data,"BsmtFinSF2"),"BsmtFinSF2")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte degli edifici ha un semiterrato finito di tipo 2 di area compresa tra 178.5 e 551.0 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Rimangono ancora degli outlier

#### Rimozione di outlier

```{r, warning = F}
rm_outlier_data = rm_oultiers(rm_0_data,.95)
visualization_continuos(rm_outlier_data, univariate_analysis(rm_outlier_data,"BsmtFinSF2"),"BsmtFinSF2")
```

Possiamo dedurre nella distribuzione semi-normato che la maggior parte degli edifici ha un semiterrato finito di tipo 2 di area compresa tra 173.8 e 512.2 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma.

### BsmtUnfSF

```{r, warning = F}
visualization_continuos(na.omit(HP[,"BsmtUnfSF"]), sum_info_h[8],"BsmtUnfSF")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica. Si puo osservare che l'area di semiterrato non finito è prelevantemete 0 qundi non costruitto. Per fare un analisi sugli edifici che hanno il semiterrato non finito, serve ignorare quelli con

#### Rimozione degli zero

```{r, warning = F}
rm_0_data = rm_0(na.omit(HP[,"BsmtUnfSF"]))
visualization_continuos(rm_0_data, univariate_analysis(rm_0_data,"BsmtUnfSF"),"BsmtUnfSF")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte degli edifici ha un semiterrato non finito di area compresa tra 288.0 e 843.2 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Rimangono ancora degli outlier

#### Rimozione di outlier

```{r, warning = F}
rm_outlier_data = rm_oultiers(rm_0_data,.95)
visualization_continuos(rm_outlier_data, univariate_analysis(rm_outlier_data,"BsmtUnfSF"),"BsmtUnfSF")
```

Possiamo dedurre nella distribuzione semi-normato che la maggior parte degli edifici ha un semiterrato non finito di area compresa tra 278.5 e 780.0 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma.

### TotalBsmtSF

```{r, warning = F}
visualization_continuos(na.omit(HP[,"TotalBsmtSF"]), sum_info_h[9],"TotalBsmtSF")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica. Si puo osservare che l'area totale semiterrato è prelevantemete 0 qundi non costruitto. Per fare un analisi sugli edifici che hanno il semiterrato non finito, serve ignorare quelli senza

#### Rimozione degli zero

```{r, warning = F}
rm_0_data = rm_0(na.omit(HP[,"TotalBsmtSF"]))
visualization_continuos(rm_0_data, univariate_analysis(rm_0_data,"TotalBsmtSF"),"TotalBsmtSF")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte degli edifici ha un semiterrato di area compresa tra 810.5 e 1309.5 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Rimangono ancora degli outlier

#### Rimozione di outlier

```{r, warning = F}
rm_outlier_data = rm_oultiers(rm_0_data,.95)
visualization_continuos(rm_outlier_data, univariate_analysis(rm_outlier_data,"TotalBsmtSF"),"TotalBsmtSF")
```

Possiamo notare che la maggior parte degli edifici ha un semiterrato di area compresa tra 804.0 e 1266.8 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma.

### X1stFlrSF

```{r, warning = F}
visualization_continuos(na.omit(HP[,"X1stFlrSF"]), sum_info_h[10],"X1stFlrSF")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte degli edifici ha il primo piano di area compresa tra 882 e 1391 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Rimangono ancora degli outlier

#### Rimozione di outlier

```{r, warning = F}
rm_outlier_data = rm_oultiers(HP[,"X1stFlrSF"],.95)
visualization_continuos(rm_outlier_data, univariate_analysis(rm_outlier_data,"X1stFlrSF"),"X1stFlrSF")
```

Possiamo notare che la maggior parte degli edifici ha il primo piano di area compresa tra 874 e 1344 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma.

### X2ndFlrSF

```{r, warning = F}
visualization_continuos(na.omit(HP[,"X2ndFlrSF"]), sum_info_h[11],"X2ndFlrSF")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica. Si puo osservare che l'area del secondo piano è prelevantemete 0 qundi non costruitto. Per fare un analisi sugli edifici che hanno il secondo piano, serve ignorare quelli senza

#### Rimozione degli zero

```{r, warning = F}
rm_0_data = rm_0(na.omit(HP[,"X2ndFlrSF"]))
visualization_continuos(rm_0_data, univariate_analysis(rm_0_data,"X2ndFlrSF"),"X2ndFlrSF")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte degli edifici ha il secondo piano di area compresa tra 625.0 e 926.5 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Rimangono ancora degli outlier

#### Rimozione di outlier

```{r, warning = F}
rm_outlier_data = rm_oultiers(rm_0_data,.90)
visualization_continuos(rm_outlier_data, univariate_analysis(rm_outlier_data,"X2ndFlrSF"),"X2ndFlrSF")
```

Possiamo notare che la maggior parte degli edifici ha il secondo piano di area compresa tra 634 e 895 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma.

### LowQualFinSF

```{r, warning = F}
visualization_continuos(na.omit(HP[,"LowQualFinSF"]), sum_info_h[12],"LowQualFinSF")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica. Si puo osservare che l'area dei piani fatti male è prelevantemete 0 Per fare un analisi sugli edifici che hanno i piani fatti male, serve ignorare quelli senza

#### Rimozione degli zero

```{r, warning = F}
rm_0_data = rm_0(na.omit(HP[,"LowQualFinSF"]))
print(paste("Ratio: ",length(rm_0_data)/length(na.omit(HP[,"LowQualFinSF"]))))
visualization_continuos(rm_0_data, univariate_analysis(rm_0_data,"LowQualFinSF"),"LowQualFinSF")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte degli edifici ha i piani fatti male di area compresa tra 168.2 e 477.5 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Gli edifici che hanno i piani fatti male sono cosi piccoli (rispetto al totale \~=1,8%) che si puo trascurare

### GrLivArea

```{r, warning = F}
visualization_continuos(na.omit(HP[,"GrLivArea"]), sum_info_h[13],"GrLivArea")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte degli edifici che sono sopra il seminterrato sono di area compresa tra 1130 e 1777 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Rimangono ancora degli outlier

#### Rimozione di outlier

```{r, warning = F}
rm_outlier_data = rm_oultiers(na.omit(HP[,"GrLivArea"]),.95)
visualization_continuos(rm_outlier_data, univariate_analysis(rm_outlier_data,"GrLivArea"),"GrLivArea")
```

Possiamo notare che la maggior parte degli edifici che sono sopra il seminterrato sono compresi tra 1121 e 1728 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma.

### GarageYrBlt

```{r, warning = F}
visualization_continuos(na.omit(HP[,"GarageYrBlt"]), sum_info_h[22],"GarageYrBlt")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e quindi il numero di garage costruiti crescono ogni anno La maggior parte degli garage erano costruiti fra 1961 e 2002, essendo rispettivamente il 1° e il 3° quantile e l'anno con è il massimo costruitto è nel 2005 con 65 garage

### GarageArea

```{r, warning = F}
visualization_continuos(na.omit(HP[,"GarageArea"]), sum_info_h[24],"GarageArea")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte degli garage sono di area compresa tra 334.5 e 576.0 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Rimangono ancora degli outlier

#### Rimozione di outlier

```{r, warning = F}
rm_outlier_data = rm_oultiers(na.omit(HP[,"GarageArea"]),.90)
visualization_continuos(rm_outlier_data, univariate_analysis(rm_outlier_data,"GarageArea"),"GarageArea")
```

Possiamo notare che la maggior parte degli garage sono compresi tra 358.0 e 566.0 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma.

### WoodDeckSF

```{r, warning = F}
visualization_continuos(na.omit(HP[,"WoodDeckSF"]), sum_info_h[25],"WoodDeckSF")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica. Si puo osservare che l'area del ponte di legno è prelevantemete 0 con 761 occorrenze qundi non costruitto. Per fare un analisi sui ponti di legno costruiti, serve ignorare quelli non

#### Rimozione degli zero

```{r, warning = F}
rm_0_data = rm_0(na.omit(HP[,"WoodDeckSF"]))
visualization_continuos(rm_0_data, univariate_analysis(rm_0_data,"WoodDeckSF"),"WoodDeckSF")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte dei ponte di legno sono di area compresa tra 120.0 e 240.0 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Rimangono ancora degli outlier

#### Rimozione di outlier

```{r, warning = F}
rm_outlier_data = rm_oultiers(rm_0_data,.90)
visualization_continuos(rm_outlier_data, univariate_analysis(rm_outlier_data,"WoodDeckSF"),"WoodDeckSF")
```

Possiamo notare che la maggior parte dei ponte di legno sono di area compresa tra 120.0 e 220.5 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma.

### OpenPorchSF

```{r, warning = F}
visualization_continuos(na.omit(HP[,"OpenPorchSF"]), sum_info_h[26],"OpenPorchSF")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica. Si puo osservare che l'area del portico aperto è prelevantemete 0 con 656 occorrenze qundi non costruitto. Per fare un analisi sui portico aperti, serve ignorare quelli non

#### Rimozione degli zero

```{r, warning = F}
rm_0_data = rm_0(na.omit(HP[,"OpenPorchSF"]))
visualization_continuos(rm_0_data, univariate_analysis(rm_0_data,"OpenPorchSF"),"OpenPorchSF")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte dei portico aperti sono di area compresa tra 39.00 e 112.00 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Rimangono ancora degli outlier

#### Rimozione di outlier

```{r, warning = F}
rm_outlier_data = rm_oultiers(rm_0_data,.90)
visualization_continuos(rm_outlier_data, univariate_analysis(rm_outlier_data,"OpenPorchSF"),"OpenPorchSF")
```

Possiamo notare che la maggior parte dei portico aperti sono di area compresa tra 120.0 e 220.5 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma.

### EnclosedPorch

```{r, warning = F}
visualization_continuos(na.omit(HP[,"EnclosedPorch"]), sum_info_h[27],"EnclosedPorch")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica. Si puo osservare che l'area del portico chiuso è prelevantemete 0 con 1252 occorrenze qundi non costruitto. Per fare un analisi sui portico chiusi, serve ignorare quelli non

#### Rimozione degli zero

```{r, warning = F}
rm_0_data = rm_0(na.omit(HP[,"EnclosedPorch"]))
visualization_continuos(rm_0_data, univariate_analysis(rm_0_data,"EnclosedPorch"),"EnclosedPorch")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte dei portico chiusi sono di area compresa tra 104.2 e 205.0 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Rimangono ancora degli outlier

#### Rimozione di outlier

```{r, warning = F}
rm_outlier_data = rm_oultiers(rm_0_data,.95)
visualization_continuos(rm_outlier_data, univariate_analysis(rm_outlier_data,"EnclosedPorch"),"EnclosedPorch")
```

Possiamo notare che la maggior parte dei portico chiusi sono di area compresa tra 102.0 e 200.5 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma.

### X3SsnPorch

```{r, warning = F}
visualization_continuos(na.omit(HP[,"X3SsnPorch"]), sum_info_h[28],"X3SsnPorch")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica. Si puo osservare che l'area del Portico per tre stagioni è prelevantemete 0 con 1252 occorrenze qundi non costruitto. Per fare un analisi sui Portico per tre stagioni, serve ignorare quelli non

#### Rimozione degli zero

```{r, warning = F}
rm_0_data = rm_0(na.omit(HP[,"X3SsnPorch"]))
print(paste("Ratio: ",length(rm_0_data)/length(na.omit(HP[,"X3SsnPorch"]))))
visualization_continuos(rm_0_data, univariate_analysis(rm_0_data,"X3SsnPorch"),"X3SsnPorch")

```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte dei Portico per tre stagioni sono di area compresa tra 150.8 e 239.8 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Gli Portico per tre stagioni costruiti sono cosi piccoli (rispetto al totale \~=1,6%) che si puo trascurare

### ScreenPorch

```{r, warning = F}
visualization_continuos(na.omit(HP[,"ScreenPorch"]), sum_info_h[29],"ScreenPorch")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica. Si puo osservare che l'area del Portico dello schermo è prelevantemete 0 con 1344 occorrenze qundi non costruitto. Per fare un analisi sui Portico dello schermo, serve ignorare quelli non

#### Rimozione degli zero

```{r, warning = F}
rm_0_data = rm_0(na.omit(HP[,"ScreenPorch"]))
visualization_continuos(rm_0_data, univariate_analysis(rm_0_data,"ScreenPorch"),"ScreenPorch")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte dei Portico dello schermo stagioni sono di area compresa tra 143.8 e 224.0 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Rimangono ancora degli outlier

#### Rimozione di outlier

```{r, warning = F}
rm_outlier_data = rm_oultiers(rm_0_data,.95)
visualization_continuos(rm_outlier_data, univariate_analysis(rm_outlier_data,"ScreenPorch"),"ScreenPorch")
```

Possiamo notare che la maggior parte dei Portico dello schermo sono di area compresa tra 142.2 e 214.5 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma.

### PoolArea

```{r, warning = F}
visualization_continuos(na.omit(HP[,"PoolArea"]), sum_info_h[30],"PoolArea")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica. Si puo osservare che l'area della piscina è prelevantemete 0 con 1453 occorrenze qundi non costruitto. Per fare un analisi sulle piscine, serve ignorare quelli non

#### Rimozione degli zero

```{r, warning = F}
rm_0_data = rm_0(na.omit(HP[,"PoolArea"]))
print(paste("Ration: ", length(rm_0_data)/length(na.omit(HP[,"PoolArea"]))))
visualization_continuos(rm_0_data, univariate_analysis(rm_0_data,"PoolArea"),"PoolArea")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte delle piscine sono di area compresa tra 515.5 e 612.0 piedi\^2, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Gli Portico per tre stagioni costruiti sono cosi piccoli (rispetto al totale \<1%) che si puo trascurare

### MiscVal

```{r, warning = F}
visualization_continuos(na.omit(HP[,"MiscVal"]), sum_info_h[31],"MiscVal")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica. Si puo osservare che il costo delle funzionalità varie è prelevantemete 0 con 1453 occorrenze qundi non costruitto. Per fare un analisi suli costi delle funzionalità varie, serve ignorare quelli non

#### Rimozione degli zero

```{r, warning = F}
rm_0_data = rm_0(na.omit(HP[,"MiscVal"]))
print(paste("Ratio: ", length(rm_0_data)/length(na.omit(HP[,"MiscVal"]))))
visualization_continuos(rm_0_data, univariate_analysis(rm_0_data,"MiscVal"),"MiscVal")
print(paste("Not in IQR: ",rm_0_data[rm_0_data<437.5]+rm_0_data[rm_0_data>887.5]))
print(paste("In IQR: ",rm_0_data[rm_0_data>=437.5 & rm_0_data<=887.5]))
```

Possiamo notare che la maggior parte dei costi delle funzionalità varie sono comprese tra 437.5 e 887.5 , essendo rispettivamente il 1° e il 3° quantile. Dato la variabilita dei dati e la mancanza di coerenza, dovuta alla mancanza di dati (\~=3.56%) dei dati totali, allora si potrebbe trascurare


### SalePrice

```{r, warning = F}
visualization_continuos(na.omit(HP[,"SalePrice"]), sum_info_h[34],"SalePrice")
```

Possiamo dedurre che la distribuzione è positivamente asimetrica e che la maggior parte del prezzo di vendita è compresa tra 129975 e 214000, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Rimangono ancora degli outlier

#### Rimozione di outlier

```{r, warning = F}
rm_outlier_data = rm_oultiers(na.omit(HP[,"SalePrice"]),.90)
visualization_continuos(rm_outlier_data, univariate_analysis(rm_outlier_data,"SalePrice"),"SalePrice")
```

Possiamo notare che la maggior parte del prezzo di vendita sono compresa tra 128988 e 196500, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma.

# Credit Cards - Univariata Quantitativa

## Lettura dati

```{r, warning = F}
credit_card = read.csv2("./credit_card.csv", sep = ",", stringsAsFactors=T, row.names=1)
```

## Trasformazione in numerica

```{r, warning = F}
str(credit_card)
```

Come si vede, alcuni dei variabili quantitativi sono fattori

```{r, warning = F}
is_numeric_factor <- function(factor_column) {
  all(!is.na(suppressWarnings(as.numeric(as.character(factor_column)))))
}

# Fuzione che converte fact a num
convert_factors_to_numeric <- function(data) {
  for (col in names(data)) {
    if (is.factor(data[[col]])) {
      if (is_numeric_factor(data[[col]])) {
        data[[col]] = as.numeric(as.character(data[[col]]))
      }
    }
  }
  return(data)
}

credit_w_numeric = convert_factors_to_numeric(credit_card)
str(credit_w_numeric)
```

Adesso tutti i variabili quantitaivi sono numerici

## Scelta delle colonne

```{r, warning = F}
credit_card_numeric_bool = sapply(credit_w_numeric,is.numeric)
credit_card_numeric_names = names(credit_card[credit_card_numeric_bool])
# Rimozione dell'ultimo e penultimo in quanto usato per machine learning
# e del primo in quanto ID delle persone
credit_card_numeric_names = credit_card_numeric_names[c(-15,-16)]
print("Colonne scelte: ")
print(credit_card_numeric_names)
```

## Analisi Primaria

```{r, warning = F}
Analisi_Primaria <- function(data){
  print(paste("Numeri di osservazione: ",ncol(data)))
  print(paste("Numeri di variabili: ",nrow(data)))
}
Analisi_Primaria(credit_w_numeric[ ,credit_card_numeric_names])
```

## Analisi non modificato

```{r, warning = F}
sum_info_c = lapply(credit_card_numeric_names, function(ele) {
  colummn = na.omit(credit_w_numeric[, ele])
  univariate_analysis(colummn, ele)
})
```

## Analisi

### Customer_Age

```{r, warning = F}
visualization_continuos(na.omit(credit_w_numeric[,"Customer_Age"]), sum_info_c[1],"Customer_Age")
```

Possiamo dedurre che la distribuzione è per lo più una gaussiana e che la maggior parte delle persone compreso tra 41.00 e 52.00 anni, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma La piu grande occoranze è 500 a 44 anni alineati alla retta qq della norma. Gli outlier invece si trovano ad eta di 73 e 70

### Months_on_book

```{r, warning = F}
visualization_continuos(na.omit(credit_w_numeric[,"Months_on_book"]), sum_info_c[3],"Months_on_book")
```

Possiamo dedurre che la distribuzione è per lo più una gaussiana e che la maggior parte delle persone sono registrati con la banca fra 31.00 e 40.00 mesi, La piu grande occoranze è 2463 a 36 mesi

### Total_Relationship_Count

```{r, warning = F}
visualization_discrete(na.omit(
  credit_w_numeric[,"Total_Relationship_Count"]), sum_info_c[4],"Total_Relationship_Count")
```

si osservare che la maggior parte delle persone hanno tra 3 e 5 prodotti coprendo il \~=60.31%, con la mggior parte avendo 3 prodotti a 2305 occoranze (\~=22.76%) Si osserva che la differenza tra 4,5,6 prodotti è \<1% e quindi si puo considerare di uguale possesso

### Months_Inactive_12_mon

```{r, warning = F}
visualization_discrete(na.omit(
  credit_w_numeric[,"Months_Inactive_12_mon",]), sum_info_c[5],"Months_Inactive_12_mon")
```

Possiamo osservare che la maggior parte delle persone rimangono innativi tra 1 e 3 mesi, con la maggior parte stando per 3 mesi con 3846 occoranze Si osserva che la maggior parte non vanno piu di 3 mesi prima di riattivare ma quasi sicuramente 1 mese e piu in quanto \<1% rimangono attivi costantemente (0 mesi di innativita)

### Contacts_Count_12_mon

```{r, warning = F}
visualization_discrete(na.omit(
  credit_w_numeric[,"Contacts_Count_12_mon"]), sum_info_c[6],"Contacts_Count_12_mon")
```

Possiamo osservare che la maggior parte delle persone hanno tra 2 e 3 contanti/12mesi, con la maggior parte avendo 3 contanti con 3380 occoranze

### Credit_Limit

```{r, warning = F}
visualization_continuos(na.omit(credit_w_numeric[,"Credit_Limit"]), sum_info_c[7],"Credit_Limit")
```

Possiamo osservare che la maggior parte delle persone hanno un limite di credito tra 2555 e 11068, ed esiste un anomalia al limite superiore dove non rispetta la descrescita delle occoranze del limite di credito con 34516 avendo 508 occoranze ed essendo il max pur non facendo parte del IQR

### Total_Revolving_Bal

```{r, warning = F}
visualization_continuos(na.omit(
  credit_w_numeric[,"Total_Revolving_Bal"]), sum_info_c[8],"Total_Revolving_Bal")
```

Possiamo notare che la maggior parte delle persone hanno Prestito a saldo rotativo compresa tra 359 e 1784, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Possiamo notare che la maggior parte delle persone hanno un Prestito a saldo rotativo a 0, 2470 in totale Per analizare quelli che hanno serve ignorare quelli senza

#### Rimozione degli zero

```{r, warning = F}
rm_0_data = rm_0(na.omit(
  credit_w_numeric[,"Total_Revolving_Bal"]))
visualization_continuos(rm_0_data, univariate_analysis(rm_0_data,"Total_Revolving_Bal"),"Total_Revolving_Bal")
```

Possiamo notare che la maggior parte delle persone hanno Prestito a saldo rotativo compresa tra 1132 e 1935, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Possiamo notare che la maggior parte delle persone hanno un Prestito a saldo rotativo a 2517 per un totale di 508 persone esendo fuori dal IQR

### Avg_Open_To_Buy

```{r, warning = F}
visualization_continuos(na.omit(
  credit_w_numeric[,"Avg_Open_To_Buy"]), sum_info_c[9],"Avg_Open_To_Buy")
```

Possiamo notare che la maggior parte delle persone disponibili per acquistare una linea di credito sono compresa tra 1324 e 9859, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Possiamo notare che la maggior parte delle persone hanno un Prestito a saldo rotativo a 2517 per un totale di 508 persone esendo fuori dal IQR

### Total_Amt_Chng_Q4_Q1

```{r, warning = F}
visualization_continuos(na.omit(
  credit_w_numeric[,"Total_Amt_Chng_Q4_Q1"]), sum_info_c[10],"Total_Amt_Chng_Q4_Q1")
```

Possiamo notare che la maggior parte delle Variazione dell'importo della transazione (Q4 rispetto a Q1) è compresa tra 0.6310 e 0.8590, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Possiamo notare che la maggior parte delle Variazione dell'importo della transazione (Q4 rispetto a Q1) sono a 0.791 con 36 Variazione

#### Rimozione di outlier

```{r, warning = F}
rm_outlier_data = rm_oultiers(na.omit(credit_w_numeric[,"Total_Amt_Chng_Q4_Q1"]),.98)
visualization_continuos(rm_outlier_data, univariate_analysis(rm_outlier_data,"Total_Amt_Chng_Q4_Q1"),"Total_Amt_Chng_Q4_Q1")
```

Possiamo dedurre che la distribuzione è semi-normato e che la maggior parte delle Variazione dell'importo della transazione (Q4 rispetto a Q1) sono compresa tra 0.6290 e 0.8480, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Possiamo notare che la maggior parte delle Variazione delle Variazione dell'importo della transazione (Q4 rispetto a Q1) sono a 0.791 con 36 Variazione

### Total_Trans_Amt

```{r, warning = F}
visualization_continuos(na.omit(
  credit_w_numeric[,"Total_Trans_Amt"]), sum_info_c[11],"Total_Trans_Amt")
```

Possiamo notare che la maggior parte delle Importe totali delle transazioni sono compresa tra 2156 e 4741, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Possiamo notare che la maggior parte delle Importe totali delle transazioni sono a 4253 e 4509 con 11 transazioni

### Total_Trans_Ct

```{r, warning = F}
visualization_continuos(na.omit(
  credit_w_numeric[,"Total_Trans_Ct"]), sum_info_c[12],"Total_Trans_Ct")
```

Possiamo dedurre che la distribuzione è semi-normato positivamente assimetrica e che la maggior parte delle Conteggio totale delle transazioni sono compresa tra 45.00 e 81.00, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Possiamo notare che la maggior parte delle Variazione delle Conteggio totale delle transazioni sono a 81 con 208 occoranze

### Total_Ct_Chng_Q4_Q1

```{r, warning = F}
visualization_continuos(na.omit(
  credit_w_numeric[,"Total_Ct_Chng_Q4_Q1"]), sum_info_c[13],"Total_Ct_Chng_Q4_Q1")
```

Possiamo notare che la maggior parte delle Variazione delle Variazione nel conteggio delle transazioni (Q4 rispetto a Q1) è compresa tra 0.5820 e 0.8180, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Possiamo notare che la maggior parte delle Variazione dell'importo della transazione (Q4 rispetto a Q1) sono a 0.667 con 171 Variazione

#### Rimozione di outlier

```{r, warning = F}
rm_outlier_data = rm_oultiers(na.omit(credit_w_numeric[,"Total_Ct_Chng_Q4_Q1"]),.98)
visualization_continuos(rm_outlier_data, univariate_analysis(rm_outlier_data,"Total_Ct_Chng_Q4_Q1"),"Total_Ct_Chng_Q4_Q1")
```

Possiamo dedurre che la distribuzione è semi-normato e che la maggior parte delle Variazione delle Variazione nel conteggio delle transazioni (Q4 rispetto a Q1) è compresa tra 0.5810 e 0.8100, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Possiamo notare che la maggior parte delle Variazione elle Variazione delle Variazione nel conteggio delle transazioni (Q4 rispetto a Q1) sono a 0.667 con 171 Variazione

### Avg_Utilization_Ratio

```{r, warning = F}
visualization_continuos(na.omit(
  credit_w_numeric[,"Avg_Utilization_Ratio"]), sum_info_c[14],"Avg_Utilization_Ratio")
```

Possiamo dedurre che la distribuzione è semi-normato e che la maggior parte delle Rapporto medio di utilizzo della carta è compresa tra 0.0230 e 0.5030, essendo rispettivamente il 1° e il 3° quantile e con maggior densita alineati alla retta qq della norma. Possiamo notare che la maggior parte delle Variazione elle Variazione delle Variazione nel conteggio delle transazioni (Q4 rispetto a Q1) sono a 0 con 2470 Variazione

#House price Univariate Qualitative

## Pulizia dei dati

```{r, warning = F, message = F}
HP$MSZoning <- factor(
  HP$MSZoning,
  levels = c("RL", "RM", "RH", "FV", "C (all)"),
  labels = c("Residential Low Density", "Residential Medium Density", "Residential High Density", "Floating Village Residential", "Commercial"))

HP$MSSubClass <- factor(
  HP$MSSubClass,
  levels= c("20","30","40","45","50","60","70","75","80","85","90","120","150","160","180","190"),
  labels = c("1-STORY 1946 & NEWER ALL STYLES","1-STORY 1945 & OLDER","1-STORY FINISHED ATTIC ALL AGES" ,"1-1/2 STORY UNFINISHED ALL AGES", "1-1/2 STORY FINISHED ALL AGES",	"2-STORY 1946 & NEWER",	"2-STORY 1945 & OLDER",	"2-1/2 STORY ALL AGES", "SPLIT OR MULTI-LEVEL",	"SPLIT FOYER",	"DUPLEX - ALL STYLES AND AGES",	"1-STORY PUD 1946 & NEWER",	"1-1/2 STORY PUD ALL AGES",	"2-STORY PUD 1946 & NEWER",	"PUD MULTILEVEL - INCL SPLIT LEV/FOYER",	 "FAMILY CONVERSION ALL STYLES AND AGES"),)


HP$LotShape <- factor(
  HP$LotShape,
  levels = c("Reg", "IR1", "IR2", "IR3"),
  labels = c("Regular", "Slightly irregular", "Moderately irregular", "Irregular"))

HP$LandContour <- factor(
  HP$LandContour,
  levels = c("Lvl", "Bnk", "HLS", "Low"),
  labels = c("Near Flat/Level", "Banked", "Hillside", "Depression"))

HP$Neighborhood <- factor(
  HP$Neighborhood,
  levels = c("Blmngtn", "Blueste", "BrDale", "BrkSide", "ClearCr", "CollgCr", "Crawfor", "Edwards", "Gilbert", "IDOTRR", "MeadowV", "Mitchel", "NAmes", "NoRidge", "NPkVill", "NridgHt", "NWAmes", "OldTown", "SWISU", "Sawyer", "SawyerW", "Somerst", "StoneBr", "Timber", "Veenker"),
  labels = c("Bloomington Heights", "Bluestem", "Briardale", "Brookside", "Clear Creek", "College Creek", "Crawford", "Edwards", "Gilbert", "Iowa DOT and Rail Road", "Meadow Village", "Mitchell", "North Ames", "Northridge", "Northpark Villa", "Northridge Heights", "Northwest Ames", "Old Town", "South & West of Iowa State University", "Sawyer", "Sawyer West", "Somerset", "Stone Brook", "Timberland", "Veenker"))

HP$BldgType <- factor(
  HP$BldgType,
  levels = c("1Fam", "2fmCon", "Duplex", "TwnhsE", "Twnhs"),
  labels = c("Single-family Detached", "Two-family Conversion", "Duplex", "Townhouse End Unit", "Townhouse Inside Unit"))

HP$MasVnrArea[HP$MasVnrArea == 0 | is.na(HP$MasVnrType)] <- NA

for (f in c("ExterQual", "ExterCond", "BsmtQual", "BsmtCond", "HeatingQC", "KitchenQual", "FireplaceQu", "GarageQual", "GarageCond")) {
  HP[, f] <- factor(
    HP[, f],
    levels = c("Po", "Fa", "TA", "Gd", "Ex"),
    labels = c("Poor", "Fair", "Average", "Good", "Excellent"))
}

levels(HP$CentralAir) <- c("No", "Yes")

HP$BsmtExposure <- factor(
  HP$BsmtExposure,
  levels = c("No", "Mn", "Av", "Gd"),
  labels = c("No", "Minimum", "Average", "Good"))

HP$GarageFinish <- factor(
  HP$GarageFinish,
  levels = c("Unf", "RFn", "Fin"),
  labels = c("Unfinished", "Rough finished", "Finished"))

HP$PavedDrive <- factor(
  HP$PavedDrive,
  levels = c("N", "P", "Y"),
  labels = c("Dirt/Graver", "Partial paved", "Paved"))

HP$Fence <- factor(
  HP$Fence,
  levels = c("MnWw", "GdWo", "MnPrv", "GdPrv"),
  labels = c("Minimum Wood/Wire", "Good Wood", "Minimum Privacy", "Good Privacy"))

HP$SaleType <- factor(
  HP$SaleType,
  levels = c("WD", "CWD", "VWD", "New", "COD", "Con", "ConLw", "ConLI", "ConLD", "Oth"),
  labels = c("Warranty Deed - Conventional", "Warranty Deed - Cash", "Warranty Deed - VA Loan", "Home just constructed and sold", "Court Officer", "Contract 15% Down payment", "Contract Low Down Payment", "Contract Low Interest", "Contract Low Down", "Other"))

HP$SaleCondition <- factor(
  HP$SaleCondition,
  levels = c("Normal", "Abnorml", "AdjLand", "Alloca", "Family", "Partial"),
  labels = c("Normal Sale", "Abnormal Sale", "Adjoining Land Purchase", "Allocation", "Sale between family members", "Home not completed"))


HP$OverallQual <- factor(
  HP$OverallQual,
  levels=c("1","2","3","4","5","6","7","8","9","10"))

HP$OverallCond <- factor(
  HP$OverallCond,
  levels=c("1","2","3","4","5","6","7","8","9","10")) 

for (f in c("BsmtFullBath", "BsmtHalfBath", "FullBath", "HalfBath", "BedroomAbvGr", "KitchenAbvGr", "TotRmsAbvGrd", "Fireplaces","GarageCars","MoSold","YrSold")) {
  HP[, f] <- factor(HP[, f])
}

HP$MiscFeature <- factor(
  HP$MiscFeature,
  levels =c("Elev","Gar2","Othr","Shed","TenC",NA) ,
  labels=c("Elevator","2nd Garage","Other","Shed","Tennis Court","No Feature"), 
  exclude = NULL)
attach(HP)
attach(credit_card)
```


##Funzione di analisi
```{r, warning = F, message = F}

Univar_Quality <- function(df,clmn, label=NULL, title=NULL) {
  
  Entries<-clmn
  tab<-sort(table(Entries), decreasing = T)
  freqtab<-round(prop.table(tab)*100,2)

  print(tab)
  print(freqtab)
  
  if(length(levels(clmn))<4){
      bar_plot <- ggplot(df,aes(x=clmn)) +
      geom_bar(fill = "red") +
      labs(title = paste("Distribution of elements from:", title),
           x = label,
           y = "Frequency")
    print(bar_plot)
  } else{
  bar_plot <- ggplot(df, aes(x=clmn)) +
    geom_bar(fill = "red") +
    coord_flip()+
    labs(title = paste("Distribution of elements from:", title),
         x = label,
         y = "Frequency")
  print(bar_plot)
  }
}
```

### MSSubClass

```{r, warning = F}
Univar_Quality(
  HP, MSSubClass,
  label="Subclasses",
  title="Sub Classes")
```
Possiamo notare che delle varie tipologie di abitazione che stiamo analizzando, le più comuni, con il 36.7% e il 20.5%, sono quelle a un piano e quelle a due piani successive al 1946 di tutti i stili. Inoltre le case con elementi ancora in costruzione come le "PUD" e le "Unfinished" hanno meno successo di quelle finite o recenti. Quattro elementi hanno valori trascurabili in quanto inferiori all \~1%, con "1-1/2 STORY PUD - ALL AGES" che non compare in nessun caso.

### Zoning

```{r, warning = F}
Univar_Quality(
  HP,MSZoning,
  label="Zones",
  title="Zoning")
```
La maggior parte della popolazione (\~79%) risiede in zone residenziali a bassa densità. Le zone commerciali rappresentano meno di \~1%, quindi appaiono trascurabili. Noto un diminuire della popolazione nelle aree "Residential" in base all'aumento della densità.

### Street
```{r, warning = F}
Univar_Quality(
  HP,Street,
  label="Types",
  title="Streets")
```
Notiamo uno squilibrio dei dati (1454 entrate) verso "Pave", cioè marciapiede. Le strade di ghiaia rappresentano meno dell'\~1% dei dati (6 entrate), quindi deduco siano trascurabili.

### Alley
```{r, warning = F}
Univar_Quality(
  HP,Alley,
  label="Types",
  title="Alley")
```
Noto che la maggior parte delle case non ha strade interne di accesso, ma tra quelle che lo hanno (91 elementi) la distribuzione tra ghiaia e marciapiedi è bilanciata.

### LotShape
```{r, warning = F}
Univar_Quality(
  HP,LotShape,
  label="Shapes",
  title="Lot Shape")
```
Notiamo che 925 (il \~63%) delle abitazioni hanno forma regolare e il 484 (\~33%) ha piccole irregolarità. Le case più irregolari in cambio rappresentano meno dell' \~1% delle frequenze, mostrando come tendenzialmente esse siano meno comprate/vendute per questa qualità.

### LandContour

```{r, warning = F}
Univar_Quality(
  HP,LandContour,
  label="Types",
  title="Land Contour")
```
Notiamo che tendenzialmente il \~90% circa delle case prese in analisi sono in posizioni quasi completamente piane. Case situate in zone con depressioni rappresentano la minoranza con solo 36 entrate in confronto alle 1311 della pianura.

### Utilities
```{r, warning = F}
Univar_Quality(
  HP,Utilities,
  label="Types",
  title="Utilities")
```
Notiamo che il resto delle categorie di Utilities è completamente trascurabile, visto che solo una casa appare sotto la categoria "Senza collegamento alle fogne", mentre tutte le altre possiedono tutte i principali servizi pubblici. 

### LotConfig
```{r, warning = F}
Univar_Quality(
  HP,LotConfig,
  label="Types",
  title="Lot Configurations")
```
Notiamo che la configurazione prevalente del lotto è quella interna con una frequenza di 1052, seguita poi da quella ad angolo di frequenza 263. Invece quelle con tre facciate sull'immobile sono solo 4, quindi trascurabili.

### LandSlope
```{r, warning = F}

Univar_Quality(
  HP,LandSlope,
  label="Types",
  title="Land Slopes")
```
Notiamo che la maggior parte delle proprietà (\~94%) è inclinata solo leggermente, dato coerente con LotContour che indicava una prevaelenza di case in pianura. Le abitazioni maggiormente inclinate hanno frequenza inferiore all' \~1%, quindi sono trascurabili.

### Neighborhood
```{r, warning = F}
Univar_Quality(
  HP,Neighborhood, 
  label="Neighborhoods",
  title="Neighborhoods")
```
Notiamo che le frequenze maggiori si verificano per North Ames (225), seguita da College Creek (150), Old town e Edwards che sono vicini (113 e 100). I Vicinati meno significativi a livello di frequenza sono "Veenker", "North Park Villa" e "Bluestem", tutti sotto l' \~1%.

### Condition1
```{r, warning = F}
Univar_Quality(
  HP,Condition1,
  label="Conditions",
  title="First Conditions")
```
Notiamo che la maggior parte della popolazione analizzata risiede in luoghi senza vicinanze degne di nota. Le più diffuse tra queste sono quella a una strada di svincolo o a una strada arteria. Molto meno diffuse invece sono le case in prossimità della ferrovia, le quali in questo caso risultano trascurabili.

### Condition2
```{r, warning = F}

Univar_Quality(
  HP,Condition2,
  label="Conditions",
  title="Second Conditions")
```
Notiamo che i dati sono molto sbilanciati, con 1445 (o il 98%) case senza alcuna vicinanza degna di nota. Tutte le altre condizioni hanno frequenza inferiore all' \~1%.

### BldgType
```{r, warning = F}
Univar_Quality(
  HP,BldgType, 
  label="Types",
  title="Building Types")
```
Notiamo che il tipo di abitazione più diffuso è quello staccato per una famiglia con l' \~84% di frequenze.  Le unità terminali di residenze a schiera hanno frequenza 114, mentre le altre tipologie hanno frequenze decrescenti e molto basse, ma non inferiori all'\~1%.

### HouseStyle
```{r, warning = F}
Univar_Quality(
  HP,HouseStyle,
  label="Styles",
  title="House Styles")
```
Notiamo che gli stili più diffusi sono quello a un piano e quello a due piani che insieme compongono l'\80% degli elementi. Le abitazioni in stato non finito invece rappresentano la minoranza in questo grafico, risultando ognuna sotto l'\1%.

### OverallQual
```{r, warning = F}
Univar_Quality(
  HP,OverallQual,
  label="Scores",
  title="House Quality")
```
Notiamo che la maggioranza delle abitazioni considerate vengono considerate a livello di qualità attorno o superiore alla media, con frequenza di 397 per "nella media", 374 per "sopra la media" e 319 per "buono". Tra i voti negativi il più degno di nota è il 4, con 116 entrate. Il numero complessivo di case valutate sotto il 3 è di 5, quindi sono frequenze trascurabili in questo caso.

### OverallCond
```{r, warning = F}
Univar_Quality(
  HP,OverallCond,
  label="Scores",
  title="House Conditions")
```
Troviamo la maggior parte delle frequenze sotto la valutazione "nella media", con una prevalenza verso le valutazioni positive. Notiamo che nessuna casa ha valutazione 10, e le case valutate sotto il 3 sono in totale 6, un numero trascurabile rispetto alle 821 valutate 5.


### RoofStyle
```{r, warning = F}
Univar_Quality(
  HP,Condition2,
  label="Styles",
  title="Roof Styles")
```
I dati sono sbilanciati completamente verso lo stile normale (\~99% circa), rendendo trascurabili tutte le altre opzioni aventi tutte meno del 0.5% frequenza.

### RoofMatl
```{r, warning = F}
Univar_Quality(
  HP,RoofMatl, 
  label="Materials",
  title="Roof Materials")
```
Notiamo che i dati sono sbilanciati (\~98%) verso l'utilizzo di una tipologia normale di materiale per il tetto, mentre tutte le altre sono estremamente basse .

### Exterior1st
```{r, warning = F}
Univar_Quality(
  HP,Exterior1st,
  label="Materials",
  title="First Exterior Covering")
```
Notiamo che le coperture in vinile sono le più diffuse con una frequenza del \~35%, mentre quelle in tavola dura, quelle in metallo e quelle in legno sono tutte diffuse in modo bilanciato, avendo a \~15% di frequenza ognuno. Più elementi, come le coperture in pietra, asfalto, mattoni e stucco sono presenti in quantità trascurabili.

### Exterior2nd
```{r, warning = F}
Univar_Quality(
  HP,Exterior2nd,
  label="Materials",
  title="Second Exterior Covering")
```
Notiamo che tra i secondi rivestimenti, il più diffuso rimane quello in vinile con 504 di frequenza, con quello di metallo, quello di tavola dura e quelli in legno distribuiti equamente ognuno con all'incirca 220 di frequenza. I meno presenti invece risultano essere quelli in imitazione di stucco, in asfato, in pietra,in mattoni e in calcestruzzo.
 
### MasVnrType
```{r, warning = F}
Univar_Quality(
  HP,MasVnrType,
  label="Types",
  title="Masonry Veneer Types")
```
Notiamo che la cosa più diffusa è l'assenza di rivestimenti in muratura (~\60%). Tra gli elementi restanti, il rivestimento più diffuso è quello in mattoni (\~30%), seguito da quello in pietra (\~9%). 

### ExterQual
```{r, warning = F}

Univar_Quality(
  HP,ExterQual,
  label="Scores",
  title="External Quality")
```
Notiamo che la maggior parte delle valutazioni cade sotto "Nella media" con frequenza di 906. Le valutazioni "buone" rappresentano il \~33% di quelle analizzate, mentre quelle negative risultano trascurabili.

### ExterCond
```{r, warning = F}
Univar_Quality(
  HP,ExterCond,
  label="Scores",
  title="External Condition")
```
Notiamo che tra le valutazioni delle condizioni esterne, la più diffusa è "nella media" rappresentando l' \~88%  delle frequenze. Le restanti percentuali sono principalmente trovate in "buono" (\~10%) e "accettabile" (\~2%). Le restanti valutazioni risultano trascurabili.

### Foundation
```{r, warning = F}
Univar_Quality(
  HP,Foundation,
  label="Materials",
  title="Foundation Types")
```
Tra le tipologie di fondamenta notiamo una equa distibuzione della maggior parte delle frequenze tra cemento (\~44%) e calcestruzzo (\~43%). Tra le restanti tipologie, quella in mattoni rappresenta il \~10% con 146 di frequenza, mentre quelle in legno e pietra appaiono trascurabili.

### BsmtQual
```{r, warning = F}
Univar_Quality(
  HP,BsmtQual,
  label="Score",
  title="Basement Quality")
```
Notiamo che tra gli immobili che hanno il seminterrato, la maggior parte di questi si presentano di qualità medio/buona con frequenze di rispettivamente 649 e 618. Notiamo anche che 36 (\~2,5%) abitazioni non possiedono il seminterrato.

### BsmtCond
```{r, warning = F}
Univar_Quality(
  HP,BsmtCond,
  label="Scores",
  title="Basement Conditions")
```
Notiamo che 1311 valutazioni "nella media" compongono il \~92% delle frequenze, con "buono" e "accettabile" appena a \~4.6% e \~3.2%. Nessun seminterrato è stato valutato "eccellente" e "povero" risulta trascurabile in quanto applicata solo a 2 elementi. Notiamo anche che 36 (\~2,5%) abitazioni non possiedono il seminterrato.

### BsmtExposure
```{r, warning = F}
Univar_Quality(
  HP,BsmtExposure,
  label="Exposure",
  title="Basement Exposure")
```
Notiamo che nella maggior parte delle abitazioni con seminterrati essi non sono esposti affatto (frequenza di 953), mentre i restanti sono divisi in "mediamente esposti" con 221 e quasi equamente tra "esposizione buona" 134 e "esposizione minima" 114. Notiamo anche che 36 (\~2,5%) abitazioni non possiedono il seminterrato.

### BsmtFinType1
```{r, warning = F}
Univar_Quality(
  HP,BsmtFinType1,
  label="Ratings",
  title="Completion Basement Ratings")
```
Analizzando i livelli di completamento notiamo che abbiamo delle distribuzioni simili tra i "non finiti" e quelli in "buone condizioni, entrambi attorno al \~30%. Non ci sono informazioni trascurabili.

### BsmtFinType2
```{r, warning = F}
Univar_Quality(
  HP,BsmtFinType2,
  label="Ratings",
  title="Extra Completion Basement Ratings")
```
Notiamo che nel caso in cui i seminterrati sono composti da più camere, quelle non principali risultano nel nostro caso essere prevalentemente "non finite" con una frequenza di 1256.

### Heating
```{r, warning = F}
Univar_Quality(
  HP,Heating,
  label="Types",
  title="Heating Plans")
```
Notiamo che il \98% circa della case analizzate hanno tutte il riscaldamento basato su fornaci ad aria calda. Delle restanti tipologie, quelle ad acqua calda sono le più prevalenti, anche se sono rappresentate tutte da basse frequenze.

### HeatingQC
```{r, warning = F}
Univar_Quality(
  HP,HeatingQC,
  label="Ratings"
  ,title="Heating Quality")
```
Notiamo che la maggior parte dei voti risulta positiva con frequenze 741 per "eccellente", 428 per "nella media" e 241 per "buono". Con frequenza 49, "accettabile" appare l'unico voto negativo degno di nota.

### CentralAir
```{r, warning = F}
Univar_Quality(
  HP,CentralAir,
  label="Exists",
  title="Central Air Conditioning")
```
Notiamo che con frequenza 1365, la maggior parte delle abitazioni ha installato un sistema di condizionatori dell'aria centralizzato.

### Electrical
```{r, warning = F}
Univar_Quality(
  HP,Electrical,
  label="Type",
  title="Electrical System")
```
Notiamo che la maggior parte dei sistemi elettrici installati (\91%) impiegano il salvavita, mentre il resto delle popolazioni significanti sono quelle del fusibile A e del fusibile F.

### BsmtFullBath

```{r, warning = F}
visualization_discrete(
  na.omit(HP[,"BsmtFullBath"]),
  sum_info_h[14],
  "BsmtFullBath")
```

Si osserva che la maggior parte dei semiterrati non hanno un bagno completo essendo il \~=58.6% con frequenza di 856 Si osserva che la minima freq dei numeri di bagno completi e 1 per 3 bangi e quindi si puo trascurare essendo \<1% Si osserva che la freq dei numeri di bagni completi per 2 bagni e 15 che è \~= 1.03% e quindi anch'esso trascurabile Infine si osserva che la maggior parte dei semiterrati che hanno 1 bagno completo è \~=40.3% con frequenza di 588

### BsmtHalfBath

```{r, warning = F}
visualization_discrete(
  na.omit(HP[,"BsmtHalfBath"]),
  sum_info_h[15],
  "BsmtHalfBath")
```

Si osserva che la maggior parte dei semiterrati non hanno un bagno mezzo completo essendo il \~94% con frequenza di 1378 Si osserva che la freq dei numeri di bagni mezzi completi per 2 bagni e 2 che è \~= 1% e quindi anch'esso trascurabile Infine si osserva che la maggior parte dei semiterrati che hanno 1 bagno mezzo completo è \~5% con frequenza di 80

### FullBath

```{r, warning = F}
visualization_discrete(
  na.omit(HP[,"FullBath"]),
  sum_info_h[16],"FullBath")
```

Si osserva che la maggior parte degli edifici che sono sopra il seminterrato hanno 2 bagni completi essendo il \~=52.6% con frequenza di 768 Si osserva che la minima freq dei numeri di bagno completi e 9 per nessun bango e quindi si puo trascurare essendo \<1% Si osserva che la freq dei numeri di bango completi per 3 bangi e 33 che è \~= 2.2% e quindi anch'esso trascurabile Infine si osserva che gli edifici che sono sopra il seminterrato che hanno 1 bagno completo sono il \~=44.5% con frequenza di 650

### HalfBath

```{r, warning = F}
visualization_discrete(
  na.omit(HP[,"HalfBath"]),
  sum_info_h[17],
  "HalfBath")
```

Si osserva che la maggior parte degli edifici che sono sopra il seminterrato hanno 0 bagni mezzo completi essendo il \~=62.5% con frequenza di 913 Si osserva che la minima freq dei numeri di bagno completi e 12 per 2 bango e quindi si puo trascurare essendo \<1% Infine si osserva che gli edifici che sono sopra il seminterrato che hanno 1 bagno completo sono il \~=36.6% con frequenza di 535


### BedroomAbvGr

```{r, warning = F}
visualization_discrete(
  na.omit(HP[,"BedroomAbvGr"]),
  sum_info_h[18],
  "BedroomAbvGr")
```

Si osserva che la maggior parte degli edifici che sono sopra il seminterrato hanno 3 camere essendo il \~=55.07% con frequenza di 804 seguito da 2, 4 e 1 camere essendo \~=24.5%, \~=14.6% e \~=3.4% con frequenze 358, 213 e 50 rispettivamente. Si osserva che la minima freq dei numeri di camere e 1 per 8 camere seguito da 5, 6 e 0 camere con frequenze 21, 7 e 6 rispettivamente e quindi si puo trascurare essendo tutti \<1.5%

### KitchenAbvGr

```{r, warning = F}
visualization_discrete(
  na.omit(HP[,"KitchenAbvGr"]),
  sum_info_h[19],
  "KitchenAbvGr")
```

Si osserva che la maggior parte degli edifici che sono sopra il seminterrato hanno 1 cucina essendo il \~=95.34% con frequenza di 1392 seguito da 2 cucine essendo \~=4.45% con frequenze 65. Si osserva che la minima freq dei numeri di camere e 1 per 0 cucine seguito da 3 cucine con frequenze 2 e quindi si puo trascurare essendo tutti \<1%

### TotRmsAbvGrd

```{r, warning = F}
visualization_discrete(
  na.omit(HP[,"TotRmsAbvGrd"]),
  sum_info_h[20],
  "TotRmsAbvGrd")
```

Si osserva che la maggior parte degli edifici che sono sopra il seminterrato sono nel intervallo fra 5 e 7 stanze (non considerando i bagni) essendo il \~=68.8% con il piu grande di occorenze 6 stanze (\~=27.5%) con frequenza di 402. Si osserva che la minima freq dei numeri di stanze e 1 per 2 e 14 stanze seguito da 12, 3 e 11 stanze con frequenze 11, 17 e 18 rispettivamente e quindi si puo trascurare essendo tutti \<1.5%


### Functional
```{r, warning = F}
Univar_Quality(
  HP,Functional,
  label="Type",
  title="Home Functionality")
```
I dati sono fortemente sbilanciati verso una funzionalità tipica della casa, rappresentando il \93% delle frequenze. Le abitazioni danneggiate rappresentano una minoranza in questi dati, risultando trascurabili.

### Fireplaces
```{r, warning = F}
Univar_Quality(
  HP,Fireplaces,
  label="Amount",
  title="Number of Fireplaces")
```
Notiamo che nel \~47% degli immobili analizzati essi risultano senza stufe a legna. Di quelli che ne posseggono, osserviamo che il \~45% contiene una sola stufa, l'\~8% due e meno dell'\~1% tre.

### FireplaceQu
```{r, warning = F}
Univar_Quality(
  HP,FireplaceQu,
  label="Rating",
  title="Fireplace Quality")
```
Notiamo che tra le abitazioni dotate di camini, 380 (\~49%) di esse lo hanno valutato come "buono", 313 (\~40%) come "nella media". Gli "eccellenti" e i "poveri" risultano avere numeri paragonabili, con 24 (\~3.1%) e 20 di frequenza.(\~2.6%)

### GarageType
```{r, warning = F}
Univar_Quality(
  HP,GarageType,
  label="Types",
  title="Garage Type")
```
Notiamo che tra i tipi di garage associati alle varie abitazioni controllate risultano 870 (\~63%) di essi attaccati alla stessa, 387 (\~28%) staccati e 88 (\~6%) costruiti dentro l'edificio. Osserviamo anche che le abitazioni con due garage di tipi diversi o l'entrata per la macchina risultano nel complessivo trascurabili.

### GarageFinish
```{r, warning = F}
Univar_Quality(
  HP,GarageFinish,
  label="Status",
  title="Garage Finishing Status")
```
Tra le case dotate di garage, osserviamo che 605 (\~44%) di essi risulta non completato, mentre quelli finiti e quelli quasi completi sono 422 (\~31%) e 352 (\~26%). Quindi nel complessivo il numero di garage generalmente quasi completi è superiore a quello dei garage incompleti. Osserviamo anche che 81 immobili non hanno il garage.

### GarageCars

```{r, warning = F}
visualization_discrete(
  na.omit(HP[,"GarageCars"]),
  sum_info_h[23],
  "GarageCars")
```

Si osserva che la maggior parte degli Garage possono avere 2 auto essendo il \~=56.44% con frequenza di 824 seguito da 1, 3 e 0 auto essendo \~=25.27% con frequenze 369, \~=12.4% con frequenze 181 e \~=5.55% con frequenze 81 rispettivamente. Notiamo che la minima freq dei numeri di auto e 5 per 4 auto e quindi si puo trascurare essendo \<1%

### GarageQual
```{r, warning = F}
Univar_Quality(HP,GarageQual, label="Rating",title="Garage Quality")
```
Notiamo che i dati sono principalmente concentrati su "nella media", con una frequenza di 1311 (\~95%). I voti "eccellente" e "povero" risultano applicati a una popolazione molto piccola dalla frequenza di 3 ognuno, quindi appaiono trascurabili.

### GarageCond
```{r, warning = F}
Univar_Quality(
  HP,GarageCond,
  label="Rating",
  title="Garage Conditions")
```
Le distribuzioni riguardanti le condizioni sembrano rispecchiare quelli della qualità, questa volta con 1326 (\~96%) di frequenza.

### PavedDrive
```{r, warning = F}
Univar_Quality(
  HP,PavedDrive,
  label="Types",
  title="Driveway Type")
```
Notiamo che le frequenze riguardanti il tipo di viale si concentrano principalmente su "pavimentato" con frequenza del 1340 (\~92%).

### PoolQC
```{r, warning = F}
Univar_Quality(
  HP,PoolQC,
  label="Rating",
  title="Pool Quality")
```
Osserviamo che 1453 delle abitazioni considerate non posseggono la piscina, con i restanti 7 quasi equamente distribuiti sulle altre valutazioni. Per questo motivo il dato risulta quasi interamente trascurabile.

### Fence
```{r, warning = F}
Univar_Quality(
  HP,Fence,
  label="Rating",
  title="Fence Rating")
```
Notiamo che le case senza alcun recinto hanno una frequenza di 1179, quindi sono la maggioranza. Delle restanti 281, 157 hanno privacy minima (\~55%), 59 hanno buona privacy (\~21%) e 54 (\~20%) hanno buon legno.

### MiscFeature
```{r, warning = F}
Univar_Quality(
  HP,MiscFeature,
  label="Type",
  title="Miscellaneous Feature")
```
Notiamo che 1406 immobili risultano non avere alcun elemento aggiuntivo, mentre tra quelle che lo hanno, le uniche degne di nota sembrano essere quelle con un capanno, le quali compongono il 3% (frequenza 49) delle case complessive, mentre le altre risultano trascurabili.

### MoSold

```{r, warning = F}
visualization_discrete(na.omit(HP[,"MoSold"]), sum_info_h[32],"MoSold")
```

Possiamo notare che i mesi con le moggior vendute sono fra il 5 e 8 mese con8 \~=55.69% Dal 1 si ha una crescita di vendute fino al 6 mese dove si il massimo di vendite con 253 vendite dopodicche la vendita decresce

### YrSold

```{r, warning = F}
visualization_discrete(
  na.omit(HP[,"YrSold"]),
  sum_info_h[33],
  "YrSold")
```

Si puo notare che la vendita per anno dal 2006 a 2009 e per lo piu uniforme con l'anno di maggior vendita nel 2009 con 338 venidite Nel 2010 invece si ha il minimo di vendite con 175 vendite

### SaleType
```{r, warning = F}
Univar_Quality(
  HP,SaleType,
  label="Type",
  title="Sale Type")
```
Osserviamo che le distribuzioni di questa tabella sono sbilanciate verso "certificato di garanzia", avendo frequenza di 1267 (\~87%). Tra le altre tipologie di pagamento noto "casa appena costruita e venduta" e "tramite ufficiale del tribunale", che rappresentano l' \~8% e il \~3% delle frequenze. Le restanti categorie risultano trascurabili.

### SaleCondition
```{r, warning = F}
Univar_Quality(
  HP,SaleCondition,
  label="Type",
  title="Sale Condition")
```
Osserviamo che la maggior parte degli acquisti si è svolta in maniera normale, data la frequenza di 1198 (\~86.78%), mentre il resto si è prevalentemente eseguito ad abitazione non completata (\~9%), in maniera anomala (\~7%) o in alcuni casi tra parenti (\~1%). Le restanti modalità si presentano meno dell'\~1% delle volte


# Credit Card univariata qualitativa


### Attrition_Flag
```{r, warning = F}
Univar_Quality(credit_card,Attrition_Flag,
               label="Types",
               title="Attrition flag")
```
Osserviamo che dei 10127 clienti, 8500 di essi (\~84%) sono utenti esistenti e attivi, mentre i restanti 1627 (\~16%) risultano essere utenti inattivi o dal conto bloccato.

### Gender
```{r, warning = F}
Univar_Quality(
  credit_card,Gender,
  label="",
  title="Gender")
```
Notiamo che la distribuzione dei sessi dei clienti risulta quasi bilanciata, con un lieve prevalere di quello femminile, dalla frequenza di 5358 (\~52%), su quello maschile, di frequenza 4769 (\~47%).

### Dependent_count
```{r, warning = F}
Univar_Quality(
  credit_card,Dependent_count,
  label="Amount",
  title="Dependent Count")
```

Si può osservare che la maggior parte delle persone hanno tra 1 e 3 dipendenti coprendo il \~=71.35%, con la maggior parte avendo 3 dipendenti a 2732 occorrenze (\~=26.98%)

### Education_Level
```{r, warning = F}
Univar_Quality(
  credit_card,Education_Level,
  label="Education",
  title="Education Level")
```
Notiamo che tra i membri di questa banca risultano esserci una prevalenza di laureati, avendo frequenza 3128, ovvero il \~=31% dei clienti complessivi, seguito da quelli che hanno superato gli studi in una scuola superiore (2013) che sono il \~=20%. Osserviamo che le frequenze di "sconosciuto" e "senza studi" sono paragonabili , avendo entrambi quasi il \~=15% ognuno del complessivo. Sono vicini anche il numero di "post-laureati" e "Dottorandi", attorno al 5% delle frequenze totali ognuno.

### Marital_Status
```{r, warning = F}
Univar_Quality(
  credit_card,Marital_Status,
  label="Status",
  title="Marital Status")
```
La distribuzione di questa variabile è relativamente bilanciata tra "Single" (single+divorziati) e "Sposati" con  \~=46% ognuno, quindi accorperei single e divorziati in un unico livello per un miglior bilanciamento. Inoltre abbiamo 749 utenti dei quali non conosciamo lo status, quindi probabilmente non risulteranno utili in un modello predittivo.

### Income_Category
```{r, warning = F}
Univar_Quality(
  credit_card,Income_Category,
  label="Income",
  title="Income Category")
```

Osservo che il \~=52% degli utenti complessivi appartiene alle fasce inferiori ai $60K, con un maggior numero di utenti sotto i $40K (3561) rispetto a quelli tra $40k e $60k. Tra i restanti, 1112 di essi non sappiamo in che categoria ricadano, quindi è probabilmente un dato trascurabile o da chiarificare; e gli utenti con più di $60K rappresentano il \~=36% degli iscritti complessivi. 

### Card_Category
```{r, warning = F}
Univar_Quality(
  credit_card,Card_Category,
  label="Category",
  title="Card Categories")
```

Il \~=93% degli utenti possiede una carta di tipo "Blue", seguiti dagli utenti "Silver" (\~=5%) e "Gold" (\~=1%). Gli utenti di categoria "Platinum" rappresentano meno dell' \~=1%, con una frequenza di 20.

```{r, warning = F}
detach(HP)
detach(credit_card)
```

# House Price - Bivariata

## Lettura dati

```{r, warning = F}
HP <- read.csv2(
    "./house_price.csv", 
    sep = ",", 
    stringsAsFactors = T)
```

## Pulizia dei dati

```{r, warning = F, message = F}
HP$MSSubClass <- factor(
    HP$MSSubClass,
    levels = c(20, 30, 40, 45, 50, 60, 70, 75, 80, 85, 90, 120, 150, 160, 180, 190),
    labels = c("1-STORY 1946 & NEWER ALL STYLES", "1-STORY 1945 & OLDER", "1-STORY W/FINISHED ATTIC ALL AGES", "1-1/2 STORY - UNFINISHED ALL AGES", "1-1/2 STORY FINISHED ALL AGES", "2-STORY 1946 & NEWER", "2-STORY 1945 & OLDER", "2-1/2 STORY ALL AGES", "SPLIT OR MULTI-LEVEL", "SPLIT FOYER", "DUPLEX - ALL STYLES AND AGES", "1-STORY PUD - 1946 & NEWER", "1-1/2 STORY PUD - ALL AGES", "2-STORY PUD - 1946 & NEWER", "PUD - MULTILEVEL - INCL SPLIT LEV/FOYER", "2 FAMILY CONVERSION - ALL STYLES AND AGES"))

HP$MSZoning <- factor(
    HP$MSZoning,
    levels = c("RL", "RM", "RH", "FV", "C (all)"),
    labels = c("Residential Low Density", "Residential Medium Density", "Residential High Density", "Floating Village Residential", "Commercial"))

HP$LotShape <- factor(
    HP$LotShape,
    levels = c("Reg", "IR1", "IR2", "IR3"),
    labels = c("Regular", "Slightly irregular", "Moderately irregular", "Irregular"))

HP$LandContour <- factor(
    HP$LandContour,
    levels = c("Lvl", "Bnk", "HLS", "Low"),
    labels = c("Near Flat/Level", "Banked", "Hillside", "Depression"))

HP$Neighborhood <- factor(
    HP$Neighborhood,
    levels = c("Blmngtn", "Blueste", "BrDale", "BrkSide", "ClearCr", "CollgCr", "Crawfor", "Edwards", "Gilbert", "IDOTRR", "MeadowV", "Mitchel", "Names", "NoRidge", "NPkVill", "NridgHt", "NWAmes", "OldTown", "SWISU", "Sawyer", "SawyerW", "Somerst", "StoneBr", "Timber", "Veenker"),
    labels = c("Bloomington Heights", "Bluestem", "Briardale", "Brookside", "Clear Creek", "College Creek", "Crawford", "Edwards", "Gilbert", "Iowa DOT and Rail Road", "Meadow Village", "Mitchell", "North Ames", "Northridge", "Northpark Villa", "Northridge Heights", "Northwest Ames", "Old Town", "South & West of Iowa State University", "Sawyer", "Sawyer West", "Somerset", "Stone Brook", "Timberland", "Veenker"))

HP$BldgType <- factor(
    HP$BldgType,
    levels = c("1Fam", "2fmCon", "Duplex", "TwnhsE", "Twnhs"),
    labels = c("Single-family Detached", "Two-family Conversion", "Duplex", "Townhouse End Unit", "Townhouse Inside Unit"))

HP$MasVnrArea[HP$MasVnrArea == 0 | is.na(HP$MasVnrType)] <- NA

for (f in c("ExterQual", "ExterCond", "BsmtQual", "BsmtCond", "HeatingQC", "KitchenQual", "FireplaceQu", "GarageQual", "GarageCond")) {
    HP[, f] <- factor(
        HP[, f],
        levels = c("Po", "Fa", "TA", "Gd", "Ex"),
        labels = c("Poor", "Fair", "Average", "Good", "Excellent"))
}

levels(HP$CentralAir) <- c("No", "Yes")

HP$BsmtExposure <- factor(
    HP$BsmtExposure,
    levels = c("No", "Mn", "Av", "Gd"),
    labels = c("No", "Minimu", "Average", "Good"))

HP$GarageFinish <- factor(
    HP$GarageFinish,
    levels = c("Unf", "RFn", "Fin"),
    labels = c("Unfinished", "Rough finished", "Finished"))

HP$PavedDrive <- factor(
    HP$PavedDrive,
    levels = c("N", "P", "Y"),
    labels = c("Dirt/Graver", "Partial paved", "Paved"))

HP$Fence <- factor(
    HP$Fence,
    levels = c("MnWw", "GdWo", "MnPrv", "GdPrv"),
    labels = c("Minimum Wood/Wire", "Good Wood", "Minimum Privacy", "Good Privacy"))

HP$SaleType <- factor(
    HP$SaleType,
    levels = c("WD", "CWD", "VWD", "New", "COD", "Con", "ConLw", "ConLI", "ConLD", "Oth"),
    labels = c("Warranty Deed - Conventional", "Warranty Deed - Cash", "Warranty Deed - VA Loan", "Home just constructed and sold", "Court Officer", "Contract 15% Down payment", "Contract Low Down Payment", "Contract Low Interest", "Contract Low Down", "Other"))

HP$SaleCondition <- factor(
    HP$SaleCondition,
    levels = c("Normal", "Abnorml", "AdjLand", "Alloca", "Family", "Partial"),
    labels = c("Normal Sale", "Abnormal Sale", "Adjoining Land Purchase", "Allocation", "Sale between family members", "Home not completed"))

attach(HP)
```

## Funzioni di analisi

Seconda variabile qualitativa:

```{r, warning = F}
analysis.qualitative <- function(data, horizontal = F, lab = NULL, title = NULL) {
    if (missing(data) | !is.factor(data)) {
        stop("Missing data or data is not a factor.")
    }
    if (!is.logical(horizontal)) {
        stop("Horizontal must be boolean")
    }
    
    df <- subset(data.frame(SalePrice, data), !is.na(data))
    
    test <- aov(SalePrice ~ data)
    p <- summary(test)[[1]][["Pr(>F)"]][1]
    
    plt <- ggplot(
        df,
        aes(
            x = if (horizontal) SalePrice else data, 
            y = if (horizontal) data else SalePrice)) +
    geom_violin(
        trim = F, 
        draw_quantiles = c(0.25, 0.5, 0.75)) +
    stat_summary(
        fun = "mean",
        geom = "point",
        color = "red",
        fill = "red",
        shape = 20,
        size = 2) +
    labs(
        title = if (is.null(title)) NULL else paste("Price by", title, sep = " "),
        subtitle = paste("Anova p-value = ", signif(p, 3), sep = ""),
        x = if (horizontal) "price" else lab,
        y = if (horizontal) lab else "price")
    
    plot(plt)
}
```

Seconda variabile quantitativa:

```{r, warning = F}
analysis.quantitative <- function(data, horizontal = F, lab = NULL, title = NULL) {
    if (missing(data)) {
        stop("Missing data.")
    }
    if (!is.logical(horizontal)) {
        stop("Horizontal must be boolean")
    }
    
    sp <- log(SalePrice)
    dt <- log(data)
    
    mod <- lm(sp ~ dt)
    p <- summary(mod)$coefficients[2,4]
    
    plt <- ggplot(
        data.frame(sp, dt),
        aes(
            x = if (horizontal) sp else dt, 
            y = if (horizontal) dt else sp)) +
    geom_point(size = 1) +
    geom_abline(
        intercept = coef(mod)[1], 
        slope = coef(mod)[2],
        color = "red") +
    labs(
        title = if (is.null(title)) NULL else paste("Price by", title, sep = " "),
        subtitle = paste("Linear model p-value = ", signif(p, 3), sep = ""),
        x = if (horizontal) "log price" else paste("log", lab, sep = " "),
        y = if (horizontal) paste("log", lab, sep = " ") else "log price")
    
    plot(plt)
}
```

## Analisi

### MSSubClass

```{r, warning = F}
analysis.qualitative(
    MSSubClass,
    horizontal = T,
    lab = "type",
    title = "type of dwelling")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di \approx 10\^{-79} non c'è supporto a questa ipotesi. Quindi c'è una correlazione tra il prezzo di vendità e il tipo della casa.

### Zoning

```{r, warning = F}
analysis.qualitative(
    MSZoning,
    horizontal = T,
    lab = "zoning",
    title = "zoning classification")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-79} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e il tipo della casa.

### LotFrontage

```{r, warning = F}
analysis.quantitative(
    LotFrontage,
    lab = "area",
    title = "frontage area")
```

Usando un modello di regressione lineare si può approssimare il rapporto tra le due variabili. Data come ipotesi nulla la non correttezza del modello, osserviamo che con un p-value di $ \approx 10^{-39} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e la distanza dalla strada, che è approssiabile da un modello lineare con pendenza positiva.

```{r, warning = F}
LotFrontage.exists <- factor(
    !is.na(LotFrontage), 
    levels = c(F, T), 
    labels = c("No", "Yes"))

analysis.qualitative(
    LotFrontage.exists,
    lab = "frontage exists",
    title = "frontage exists")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 0.88 $ c'è supporto all'ipotesi nulla. Quindi non c'è una correlazione tra il prezzo di vendità e l'esistenza di spazio tra casa e strada.

### LotArea

```{r, warning = F}
analysis.quantitative(
    LotArea,
    lab = "log area",
    title = "lot area")
```

Usando un modello di regressione lineare si può approssimare il rapporto tra le due variabili. Data come ipotesi nulla la non correttezza del modello, osserviamo che con un p-value di $ \approx 10^{-59} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e la dimensione del lotto, che è approssiabile da un modello lineare con pendenza positiva.

### Street

Questa variabile non viene messa in correlazione perché i dati sono troppo sbilanciati. Infatti la maggiorparte dei dati sta in una sola categoria.

```{r, echo = F, warning = F}
round(sort(table(Street), decreasing = T) / length(Street) * 100, 2)
```

### Alley

```{r, warning = F}
Alley.exists <- factor(
    !is.na(Alley), 
    levels = c(F, T), 
    labels = c("No", "Yes"))

analysis.qualitative(
    Alley.exists,
    lab = "alley exists",
    title = "alley exists")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-6} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e l'esistenza del vialetto.

### LotShape

```{r, warning = F}
analysis.qualitative(
    LotShape,
    lab = "shape",
    title = "lot shape")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-25} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e la forma del lotto.

```{r, warning = F}
LotShape.cut <- factor(
    LotShape == "Regular", 
    levels = c(T, F), 
    labels = c("Regular", "Irregular"))

analysis.qualitative(
    LotShape.cut,
    lab = "shape",
    title = "lot shape")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-25} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e la forma regolare o irregolare del lotto.

### LandContour

```{r, warning = F}
analysis.qualitative(
    LandContour,
    lab = "contour",
    title = "land contour")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-8} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e la zona in cui è situata l'abitazione.

### Utilities
Questa variabile non viene messa in correlazione perché i dati sono troppo sbilanciati. Infatti la maggiorparte dei dati sta in una sola categoria.

```{r, echo = F, warning = F}
round(sort(table(Utilities), decreasing = T) / length(Utilities) * 100, 2)
```

### LotConfig

```{r, warning = F}
analysis.qualitative(
    LotConfig,
    lab = "configuration",
    title = "lot configuration")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-6} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e la configurazione del lotto.

### LandSlope

Questa variabile non viene messa in correlazione perché i dati sono troppo sbilanciati. Infatti la maggiorparte dei dati sta in una sola categoria.

```{r, echo = F, warning = F}
round(sort(table(LandSlope), decreasing = T) / length(LandSlope) * 100, 2)
```

### Neighborhood

```{r, warning = F}
analysis.qualitative(
    Neighborhood,
    horizontal = T,
    lab = "neighborhood",
    title = "neighborhood")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-187} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e il vicinato della casa.

### Condition1

Questa variabile non viene messa in correlazione perché i dati sono troppo sbilanciati. Infatti la maggiorparte dei dati sta in una sola categoria.

```{r, echo = F, warning = F}
round(sort(table(Condition1), decreasing = T) / length(Condition1) * 100, 2)
```

### Condition2

Questa variabile non viene messa in correlazione perché i dati sono troppo sbilanciati. Infatti la maggiorparte dei dati sta in una sola categoria.

```{r, echo = F, warning = F}
round(sort(table(Condition2), decreasing = T) / length(Condition2) * 100, 2)
```

### BldgType

```{r, warning = F}
analysis.qualitative(
    BldgType,
    horizontal = T,
    lab = "type",
    title = "bilding type")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-10} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e il tipo di abitazione.

### HouseStyle

```{r, warning = F}
analysis.qualitative(
    HouseStyle,
    lab = "style",
    title = "house style")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-25} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e lo stile della casa.

### OverallQual

```{r, warning = F}
OverallQual.fact <- factor(
    OverallQual,
    levels = 1:10)

analysis.qualitative(
    OverallQual.fact,
    lab = "quality",
    title = "overall quality")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 0 $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e la qualità dei materiali.

### OverallCond

```{r, warning = F}
OverallCond.fact <- factor(
    OverallCond,
    levels = 1:10)

analysis.qualitative(
    OverallCond.fact,
    lab = "condition",
    title = "overall condition")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-38} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e le condizioni attuali dei materiali.

### YearBuilt

```{r, warning = F}
analysis.quantitative(
    YearBuilt,
    lab = "year",
    title = "year build")
```

Usando un modello di regressione lineare si può approssimare il rapporto tra le due variabili. Data come ipotesi nulla la non correttezza del modello, osserviamo che con un p-value di $ \approx 10^{-134} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e l'anno di costruzione, che è approssiabile da un modello lineare con pendenza positiva.

### YearRemodAdd

```{r, warning = F}
analysis.quantitative(
    YearRemodAdd,
    lab = "year",
    title = "remodel year")
```

Usando un modello di regressione lineare si può approssimare il rapporto tra le due variabili. Data come ipotesi nulla la non correttezza del modello, osserviamo che con un p-value di $ \approx 10^{-124} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e l'anno di ristrutturazione, che è approssiabile da un modello lineare con pendenza positiva.
### RoofStyle

```{r, warning = F}
analysis.qualitative(
    RoofStyle,
    lab = "style",
    title = "roof style")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-17} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e lo stile del tetto.

### RoofMatl

Questa variabile non viene messa in correlazione perché i dati sono troppo sbilanciati. Infatti la maggiorparte dei dati sta in una sola categoria.

```{r, echo = F, warning = F}
round(sort(table(RoofMatl), decreasing = T) / length(RoofMatl) * 100, 2)
```

### Exterior1st

```{r, warning = F}
analysis.qualitative(
    Exterior1st,
    horizontal = T,
    lab = "covering",
    title = "exteriori covering 1")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-43} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e il rivestimento esterno.

### Exterior2nd

```{r, warning = F}
analysis.qualitative(
    Exterior2nd,
    horizontal = T,
    lab = "covering",
    title = "exteriori covering 2")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-43} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e il rivestimento esterno.

### MasVnrType

```{r, warning = F}
MasVnrType.exists <- factor(
    MasVnrType != "None",
    levels = c(F, T), 
    labels = c("No", "Yes"))

analysis.qualitative(
    MasVnrType.exists,
    lab = "exists",
    title = "masonry veneer")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-49} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e la presenza dell'impiallacciatura in muratura.

### MasVnrArea

```{r, warning = F}
analysis.quantitative(
    MasVnrArea,
    lab = "area",
    title = "masonry veneer")
```

Usando un modello di regressione lineare si può approssimare il rapporto tra le due variabili. Data come ipotesi nulla la non correttezza del modello, osserviamo che con un p-value di $ \approx 10^{-15} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e l'area di impiallacciatura in muratura, che è approssiabile da un modello lineare con pendenza positiva.

### ExterQual

```{r, warning = F}
analysis.qualitative(
    ExterQual,
    lab = "quality",
    title = "external quality")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-204} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e la qualità degli esterni.

### ExterCond

```{r, warning = F}
analysis.qualitative(
    ExterCond,
    lab = "condition",
    title = "external condition")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-7} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e le attuali condizioni degli esterni.

### Foundation

```{r, warning = F}
analysis.qualitative(
    Foundation,
    lab = "type",
    title = "foundation")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-91} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e il tipo di fondamenta.

### BsmtQual

```{r, warning = F}
analysis.qualitative(
    BsmtQual,
    lab = "quality",
    title = "basement quality")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-186} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e la qualità del seminterrato.

### BsmtCond

```{r, warning = F}
analysis.qualitative(
    BsmtCond,
    lab = "condition",
    title = "basement condition")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-9} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e le condizioni attuali del meninterrato.

### BsmtExposure

```{r, warning = F}
analysis.qualitative(
    BsmtExposure,
    lab = "exposure",
    title = "basement exposure")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-6} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e l'esposizione del seminterrato.

### BsmtFinType1

```{r, warning = F}
analysis.qualitative(
    BsmtFinType1,
    lab = "class",
    title = "rating of basement finisched area 1")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-63} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e l'area finita di seminterrato.

### BsmtFinSF1

```{r, warning = F}
BsmtFinSF1.positive <- BsmtFinSF1
BsmtFinSF1.positive[BsmtFinSF1 == 0] <- NA

analysis.quantitative(
    BsmtFinSF1.positive,
    lab = "area",
    title = "basement type 1 square area")
```

Usando un modello di regressione lineare si può approssimare il rapporto tra le due variabili. Data come ipotesi nulla la non correttezza del modello, osserviamo che con un p-value di $ \approx 10^{-17} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e l'area del seminterrato, che è approssiabile da un modello lineare con pendenza positiva.

### BsmtFinType2

```{r, warning = F}
analysis.qualitative(
    BsmtFinType2,
    lab = "class",
    title = "rating of basement finisched area 2")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 0.02 $ c'è un debole supporto all'ipotesi nulla. Quindi c'è una debole correlazione tra il prezzo di vendità e la seconda area finita del seminterrato.

### BsmtFinSF2

```{r, warning = F}
BsmtFinSF2.positive <- BsmtFinSF2
BsmtFinSF2.positive[BsmtFinSF2 == 0] <- NA

analysis.quantitative(
    BsmtFinSF2.positive,
    lab = "area",
    title = "basement type 2 square area")
```

Usando un modello di regressione lineare si può approssimare il rapporto tra le due variabili. Data come ipotesi nulla la non correttezza del modello, osserviamo che con un p-value di $ \approx 0.21 $ c'è supporto all'ipotesi nulla. Quindi non c'è una correlazione tra il prezzo di vendità e l'area del secondo seminterrato. Questo probabilmente è dovuto alla scaristà nel numero dei dati.

### BsmtUnfSF

```{r, warning = F}
BsmtUnfSF.positive <- BsmtUnfSF
BsmtUnfSF.positive[BsmtUnfSF == 0] <- NA

analysis.quantitative(
    BsmtUnfSF.positive,
    lab = "area",
    title = "unfinisched area of basement")
```

Usando un modello di regressione lineare si può approssimare il rapporto tra le due variabili. Data come ipotesi nulla la non correttezza del modello, osserviamo che con un p-value di $ \approx 0.002 $ c'è un debole supporto all'ipotesi nulla. Quindi c'è una correlazione abbastanza forte tra il prezzo di vendità e l'area non finita di seminterrato, che è approssiabile da un modello lineare con pendenza positiva.

### TotalBsmtSF

```{r, warning = F}
TotalBsmtSF.positive <- TotalBsmtSF
TotalBsmtSF.positive[TotalBsmtSF == 0] <- NA

analysis.quantitative(
    TotalBsmtSF.positive,
    lab = "area",
    title = "total basement area")
```

Usando un modello di regressione lineare si può approssimare il rapporto tra le due variabili. Data come ipotesi nulla la non correttezza del modello, osserviamo che con un p-value di $ \approx 10^{-142} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e l'area del seminterrato, che è approssiabile da un modello lineare con pendenza positiva.

### Heating

Questa variabile non viene messa in correlazione perché i dati sono troppo sbilanciati. Infatti la maggiorparte dei dati sta in una sola categoria.

```{r, echo = F, warning = F}
round(sort(table(Heating), decreasing = T) / length(Heating) * 100, 2)
```

### HeatingQC

```{r, warning = F}
analysis.qualitative(
    HeatingQC,
    lab = "quality",
    title = "heating quality")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-67} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e la qualità del riscaldamento.

### CentralAir

```{r, warning = F}
analysis.qualitative(
    CentralAir,
    lab = "exists",
    title = "central air")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-22} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e l'esistenza dell'aria condizionata centralizzata.

### Electrical

```{r, warning = F}
analysis.qualitative(
    Electrical,
    lab = "type",
    title = "electrical")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-18} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e il tipo di impianto elettrico.

### X1stFlrSF

```{r, warning = F}
analysis.quantitative(
    X1stFlrSF,
    lab = "area",
    title = "first floor area")
```

Usando un modello di regressione lineare si può approssimare il rapporto tra le due variabili. Data come ipotesi nulla la non correttezza del modello, osserviamo che con un p-value di $ \approx 10^{-149} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e l'area calpestabile del piano terra, che è approssiabile da un modello lineare con pendenza positiva.

### X2ndFlrSF

```{r, warning = F}
X2ndFlrSF.positive <- X2ndFlrSF
X2ndFlrSF.positive[X2ndFlrSF == 0] <- NA

analysis.quantitative(
    X2ndFlrSF.positive,
    lab = "area",
    title = "second floor area")
```

Usando un modello di regressione lineare si può approssimare il rapporto tra le due variabili. Data come ipotesi nulla la non correttezza del modello, osserviamo che con un p-value di $ \approx 10^{-76} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e l'area calpestabile del secondo piano, che è approssiabile da un modello lineare con pendenza positiva.

### LowQualFinSF

Questa variabile non viene messa in correlazione perché i dati sono troppo sbilanciati. Infatti la maggiorparte dei dati sta in una sola categoria.

```{r, echo = F, warning = F}
round(sort(table(LowQualFinSF), decreasing = T) / length(LowQualFinSF) * 100, 2)
```

### GrLivArea

```{r, warning = F}
analysis.quantitative(
    GrLivArea,
    lab = "area",
    title = "ground living area")
```

Usando un modello di regressione lineare si può approssimare il rapporto tra le due variabili. Data come ipotesi nulla la non correttezza del modello, osserviamo che con un p-value di $ \approx 10^{-243} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e l'area calpestabile sopra il piano strada, che è approssiabile da un modello lineare con pendenza positiva.

### BsmtFullBath

```{r, warning = F}
BsmtFullBath.fact <- factor(
    BsmtFullBath,
    levels = 0:max(BsmtFullBath))

analysis.qualitative(
    BsmtFullBath.fact,
    lab = "number",
    title = "basement full bath")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-17} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e il numero di bagni completi.

### BsmtHalfBath

Questa variabile non viene messa in correlazione perché i dati sono troppo sbilanciati. Infatti la maggiorparte dei dati sta in una sola categoria.

```{r, echo = F, warning = F}
round(sort(table(BsmtHalfBath), decreasing = T) / length(BsmtHalfBath) * 100, 2)
```

### FullBath

```{r, warning = F}
FullBath.fact <- factor(
    FullBath,
    levels = 0:max(FullBath))

analysis.qualitative(
    FullBath.fact,
    lab = "number",
    title = "full bath")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-129} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e il numero di bagni completi.

### HalfBath

```{r, warning = F}
HalfBath.fact <- factor(
    HalfBath,
    levels = 0:max(HalfBath))

analysis.qualitative(
    HalfBath.fact,
    lab = "number",
    title = "half bath")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-31} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e il numero di bagni di servizio.

### BedroomAbvGr

```{r, warning = F}
BedroomAbvGr.fact <- factor(
    BedroomAbvGr,
    levels = 0:max(BedroomAbvGr))

analysis.qualitative(
    BedroomAbvGr.fact,
    lab = "number",
    title = "bedroom")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-16} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e il numero di camere da letto.

### KitchenAbvGr

Questa variabile non viene messa in correlazione perché i dati sono troppo sbilanciati. Infatti la maggiorparte dei dati sta in una sola categoria.

```{r, echo = F, warning = F}
round(sort(table(KitchenAbvGr), decreasing = T) / length(KitchenAbvGr) * 100, 2)
```

### KitchenQual

```{r, warning = F}
analysis.qualitative(
    KitchenQual,
    lab = "quality",
    title = "kitchen quality")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-192} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e la qualità della cucina.

### TotRmsAbvGrd

```{r, warning = F}
TotRmsAbvGrd.fact <- factor(
    TotRmsAbvGrd,
    levels = 0:max(TotRmsAbvGrd))

analysis.qualitative(
    TotRmsAbvGrd.fact,
    lab = "number",
    title = "rooms number above ground")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-103} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e il numero di stanze sopra il livello del terreno.

### Functional

Questa variabile non viene messa in correlazione perché i dati sono troppo sbilanciati. Infatti la maggiorparte dei dati sta in una sola categoria.

```{r, echo = F, warning = F}
round(sort(table(Functional), decreasing = T) / length(Functional) * 100, 2)
```

### Fireplaces

```{r, warning = F}
Fireplaces.fact <- factor(
    Fireplaces,
    levels = 0:max(Fireplaces))

analysis.qualitative(
    Fireplaces.fact,
    lab = "number",
    title = "fireplaces number")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-83} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e il numero di caminetti.

### FireplaceQu

```{r, warning = F}
analysis.qualitative(
    FireplaceQu,
    lab = "quality",
    title = "fireplace quality")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-19} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e la qualità dei caminetti.

### GarageType

```{r, warning = F}
analysis.qualitative(
    GarageType,
    lab = "type",
    title = "garage type")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-66} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e il tipo di garage.

```{r, warning = F}
Garage.exists <- factor(
    !is.na(GarageType),
    levels = c(F, T), 
    labels = c("No", "Yes"))

analysis.qualitative(
    Garage.exists,
    lab = "exists",
    title = "garage exists")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-20} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e l'esistenza del garage.

### GarageYrBlt

```{r, warning = F}
analysis.quantitative(
    GarageYrBlt,
    lab = "year",
    title = "garage year build")
```

Usando un modello di regressione lineare si può approssimare il rapporto tra le due variabili. Data come ipotesi nulla la non correttezza del modello, osserviamo che con un p-value di $ \approx 10^{-105} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e l'anno di costruzione del garage, che è approssiabile da un modello lineare con pendenza positiva.

### GarageFinish

```{r, warning = F}
analysis.qualitative(
    GarageFinish,
    lab = "status",
    title = "garage finished")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-93} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e lo stato di costruzione del garage.

### GarageCars

```{r, warning = F}
GarageCars.fact <- factor(
    GarageCars,
    levels = 0:max(GarageCars))

analysis.qualitative(
    GarageCars.fact,
    lab = "number",
    title = "garage size by cars number")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-6} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e la dimensione del garage misurata in numero di auto contenute.

### GarageArea

```{r, warning = F}
GarageArea.positive <- GarageArea
GarageArea.positive[GarageArea == 0] <- NA

analysis.quantitative(
    GarageArea.positive,
    lab = "square feets",
    title = "garage area")
```

Usando un modello di regressione lineare si può approssimare il rapporto tra le due variabili. Data come ipotesi nulla la non correttezza del modello, osserviamo che con un p-value di $ \approx 10^{-141} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e l'area del garage, che è approssiabile da un modello lineare con pendenza positiva.

### GarageQual

```{r, warning = F}
analysis.qualitative(
    GarageQual,
    lab = "quality",
    title = "garage quality")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-7} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e la qualità del garage.

### GarageCond

```{r, warning = F}
analysis.qualitative(
    GarageCond,
    lab = "condition",
    title = "garage condition")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-7} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e le condizioni del garage.

### PavedDrive

```{r, warning = F}
analysis.qualitative(
    PavedDrive,
    lab = "paved",
    title = "paved driveway")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-18} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e la pavimentazione del vialetto.

### WoodDeckSF

```{r, warning = F}
WoodDeckSF.positive <- WoodDeckSF
WoodDeckSF.positive[WoodDeckSF == 0] <- NA

analysis.quantitative(
    WoodDeckSF.positive,
    lab = "square feets",
    title = "wood deck")
```

Usando un modello di regressione lineare si può approssimare il rapporto tra le due variabili. Data come ipotesi nulla la non correttezza del modello, osserviamo che con un p-value di $ \approx 10^{-12} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e la dimensione del portico in legno, che è approssiabile da un modello lineare con pendenza positiva.

### OpenPorchSF

```{r, warning = F}
OpenPorchSF.positive <- OpenPorchSF
OpenPorchSF.positive[OpenPorchSF == 0] <- NA

analysis.quantitative(
    OpenPorchSF.positive,
    lab = "square feets",
    title = "open porch area")
```

Usando un modello di regressione lineare si può approssimare il rapporto tra le due variabili. Data come ipotesi nulla la non correttezza del modello, osserviamo che con un p-value di $ \approx 10^{-5} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e l'area del porticato, che è approssiabile da un modello lineare con pendenza positiva.

### EnclosedPorch

```{r, warning = F}
EnclosedPorch.positive <- EnclosedPorch
EnclosedPorch.positive[EnclosedPorch == 0] <- NA

analysis.quantitative(
    EnclosedPorch.positive,
    lab = "square feets",
    title = "encloses porch area")
```

Usando un modello di regressione lineare si può approssimare il rapporto tra le due variabili. Data come ipotesi nulla la non correttezza del modello, osserviamo che con un p-value di $ \approx 0.02 $ c'è un debole supporto all'ipotesi nulla. Quindi non c'è una forte correlazione tra il prezzo di vendità e l'area chiusa del portico.

### X3SsnPorch

```{r, warning = F}
X3SsnPorch.positive <- X3SsnPorch
X3SsnPorch.positive[X3SsnPorch == 0] <- NA

analysis.quantitative(
    X3SsnPorch.positive,
    lab = "square feets",
    title = "three season porch area")
```

Usando un modello di regressione lineare si può approssimare il rapporto tra le due variabili. Data come ipotesi nulla la non correttezza del modello, osserviamo che con un p-value di $ \approx 0.56 $ c'è supporto all'ipotesi nulla. Quindi non c'è una correlazione tra il prezzo di vendità e l'area del portico tre stagioni.

### ScreenPorch

```{r, warning = F}
ScreenPorch.positive <- ScreenPorch
ScreenPorch.positive[ScreenPorch == 0] <- NA

analysis.quantitative(
    ScreenPorch.positive,
    lab = "square feets",
    title = "screen porch area")
```

Usando un modello di regressione lineare si può approssimare il rapporto tra le due variabili. Data come ipotesi nulla la non correttezza del modello, osserviamo che con un p-value di $ \approx 0.0003 $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e il portico con zanzariera, che è approssiabile da un modello lineare con pendenza positiva.

### PoolArea

Questa variabile non viene messa in correlazione perché i dati sono troppo sbilanciati.

```{r, echo = F, warning = F}
PoolArea.exists <- PoolArea != 0
round(table(PoolArea.exists) / length(PoolArea.exists), 3)
```

### PoolQC

Questa variabile non viene messa in correlazione perché i dati sono troppo sbilanciati. Infatti la maggiorparte dei dati sta in una sola categoria.

```{r, echo = F, warning = F}
PoolQC.na <- addNA(PoolQC)
round(sort(table(PoolQC.na), decreasing = T) / length(PoolQC.na) * 100, 2)
```

### Fence

```{r, warning = F}
analysis.qualitative(
    Fence,
    lab = "quality",
    title = "fence quality")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 0.002 $ c'è un debolissimo supporto all'ipotesi nulla. Quindi c'è una correlazione abbastanza forte tra il prezzo di vendità e la qualità della recinzione.

```{r, warning = F}
Fence.exists <- factor(
    !is.na(Fence),
    levels = c(F, T), 
    labels = c("No", "Yes"))

analysis.qualitative(
    Fence.exists,
    lab = "exists",
    title = "fence exists")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-11} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e l'esistenza della recinzione

### MiscFeature

Questa variabile non viene messa in correlazione perché i dati sono troppo sbilanciati. Infatti la maggiorparte dei dati sta nella categoria NA.

```{r, echo = F, warning = F}
MiscFeature.na <- addNA(MiscFeature)
round(sort(table(MiscFeature.na), decreasing = T) / length(MiscFeature.na) * 100, 2)
```

### MiscVal

Questa variabile non viene messa in correlazione perché i dati sono troppo sbilanciati. Infatti la maggiorparte dei dati sta nella categoria 0 (non ci sono costi).

```{r, echo = F, warning = F}
round(sort(table(factor(MiscVal == 0, levels = c(T, F), labels = c("0", "> 0"))), decreasing = T) / length(MiscVal) * 100, 2)
```

### MoSold

```{r, warning = F}
MoSold.fact <- factor(
    MoSold,
    levels = 0:max(MoSold))

analysis.qualitative(
    MoSold.fact,
    lab = "month",
    title = "month sold")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 0.18 $ c'è supporto all'ipotesi nulla. Quindi non c'è una correlazione tra il prezzo di vendità e il mese di vendità.

### YrSold

```{r, warning = F}
YrSold.fact <- factor(
    YrSold,
    levels = 0:max(YrSold))

analysis.qualitative(
    YrSold.fact,
    lab = "year",
    title = "year sold")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 0.63 $ c'è supporto all'ipotesi nulla. Quindi non c'è una correlazione tra il prezzo di vendità e l'anno di vendita.

### SaleType

```{r, warning = F}
analysis.qualitative(
    SaleType,
    horizontal = T,
    lab = "type",
    title = "sale type")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-42} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e il tipo di contratto di vendita.

### SaleCondition

```{r, warning = F}
analysis.qualitative(
    SaleCondition,
    horizontal = T,
    lab = "condition",
    title = "sale condition")
```

Data l'uguaglianza delle medie come ipotesi nulla, osserviamo che con un p-value di $ \approx 10^{-44} $ non c'è supporto all'ipotesi nulla. Quindi c'è una correlazione tra il prezzo di vendità e le condizioni di vendita.